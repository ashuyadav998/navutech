"use strict";(self.webpackChunksimshop_frontend=self.webpackChunksimshop_frontend||[]).push([[143],{143(e,s,a){a.r(s),a.d(s,{default:()=>l});var r=a(555),c=a(43),i=a(774),n=a(505),t=a(579);const l=()=>{const[e,s]=(0,c.useState)([]),[a,l]=(0,c.useState)([]),[o,d]=(0,c.useState)(!0),[m,u]=(0,c.useState)(!1),[h,x]=(0,c.useState)(null),[p,g]=(0,c.useState)({name:"",slug:"",description:"",price:"",originalPrice:"",discount:0,category:"",images:[""],stock:"",sku:"",brand:"",isOffer:!1,isFeatured:!1,active:!0});(0,c.useEffect)(()=>{j()},[]);const j=async()=>{try{d(!0);const[e,a]=await Promise.all([(0,n.d$)({}),(0,n.bW)()]);s(e.data),l(a.data)}catch(e){console.error("Error al cargar datos:",e),alert("Error al cargar los datos")}finally{d(!1)}},b=e=>{const{name:s,value:a,type:c,checked:i}=e.target;if(g((0,r.A)((0,r.A)({},p),{},{[s]:"checkbox"===c?i:a})),"name"===s){const e=a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");g(s=>(0,r.A)((0,r.A)({},s),{},{slug:e}))}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(x(e),g({name:e.name,slug:e.slug,description:e.description,price:e.price,originalPrice:e.originalPrice||"",discount:e.discount||0,category:e.category._id||e.category,images:e.images.length>0?e.images:[""],stock:e.stock,sku:e.sku||"",brand:e.brand||"",isOffer:e.isOffer,isFeatured:e.isFeatured,active:e.active})):(x(null),g({name:"",slug:"",description:"",price:"",originalPrice:"",discount:0,category:"",images:[""],stock:"",sku:"",brand:"",isOffer:!1,isFeatured:!1,active:!0})),u(!0)},N=()=>{u(!1),x(null)};return o?(0,t.jsx)("div",{className:"loading",children:"Cargando productos..."}):(0,t.jsxs)("div",{className:"admin-products",children:[(0,t.jsxs)("div",{className:"page-header",children:[(0,t.jsx)("h2",{children:"Gesti\xf3n de Productos"}),(0,t.jsxs)("button",{className:"btn btn-primary",onClick:()=>v(),children:[(0,t.jsx)(i.OiG,{})," Nuevo Producto"]})]}),(0,t.jsxs)("div",{className:"table-responsive",children:[(0,t.jsxs)("table",{className:"admin-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Imagen"}),(0,t.jsx)("th",{children:"Nombre"}),(0,t.jsx)("th",{children:"Categor\xeda"}),(0,t.jsx)("th",{children:"Precio"}),(0,t.jsx)("th",{children:"Stock"}),(0,t.jsx)("th",{children:"Estado"}),(0,t.jsx)("th",{children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>{var s,a;return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("img",{src:e.images[0]||"https://via.placeholder.com/50",alt:e.name,className:"product-thumbnail"})}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:"product-name-cell",children:[(0,t.jsx)("strong",{children:e.name}),e.brand&&(0,t.jsx)("span",{className:"brand-tag",children:e.brand})]})}),(0,t.jsx)("td",{children:(null===(s=e.category)||void 0===s?void 0:s.name)||"Sin categor\xeda"}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:"price-cell",children:[(a=e.price,new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(a)),e.isOffer&&(0,t.jsxs)("span",{className:"offer-badge",children:["-",e.discount,"%"]})]})}),(0,t.jsx)("td",{children:(0,t.jsx)("span",{className:"stock-badge ".concat(e.stock<10?"low":0===e.stock?"out":""),children:e.stock})}),(0,t.jsx)("td",{children:(0,t.jsx)("span",{className:"status-badge ".concat(e.active?"active":"inactive"),children:e.active?"Activo":"Inactivo"})}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:"action-buttons",children:[(0,t.jsx)("button",{className:"btn-icon btn-edit",onClick:()=>v(e),title:"Editar",children:(0,t.jsx)(i.uO9,{})}),(0,t.jsx)("button",{className:"btn-icon btn-delete",onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este producto?"))try{await(0,n.DD)(e),alert("Producto eliminado correctamente"),j()}catch(s){console.error("Error al eliminar producto:",s),alert("Error al eliminar el producto")}})(e._id),title:"Eliminar",children:(0,t.jsx)(i.qbC,{})})]})})]},e._id)})})]}),0===e.length&&(0,t.jsx)("div",{className:"no-data",children:"No hay productos registrados"})]}),m&&(0,t.jsx)("div",{className:"modal-overlay",onClick:N,children:(0,t.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h3",{children:h?"Editar Producto":"Nuevo Producto"}),(0,t.jsx)("button",{className:"modal-close",onClick:N,children:(0,t.jsx)(i.QCr,{})})]}),(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=(0,r.A)((0,r.A)({},p),{},{price:parseFloat(p.price),originalPrice:p.originalPrice?parseFloat(p.originalPrice):0,discount:parseFloat(p.discount),stock:parseInt(p.stock),images:p.images.filter(e=>""!==e.trim())});h?(await(0,n.vc)(h._id,e),alert("Producto actualizado correctamente")):(await(0,n.WY)(e),alert("Producto creado correctamente")),N(),j()}catch(c){var s,a;console.error("Error al guardar producto:",c),alert("Error al guardar el producto: "+((null===(s=c.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||c.message))}},className:"product-form",children:[(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Nombre *"}),(0,t.jsx)("input",{type:"text",name:"name",value:p.name,onChange:b,required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Slug"}),(0,t.jsx)("input",{type:"text",name:"slug",value:p.slug,onChange:b,required:!0})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Descripci\xf3n *"}),(0,t.jsx)("textarea",{name:"description",value:p.description,onChange:b,rows:"3",required:!0})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Precio *"}),(0,t.jsx)("input",{type:"number",name:"price",value:p.price,onChange:b,step:"0.01",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Precio Original"}),(0,t.jsx)("input",{type:"number",name:"originalPrice",value:p.originalPrice,onChange:b,step:"0.01"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Descuento (%)"}),(0,t.jsx)("input",{type:"number",name:"discount",value:p.discount,onChange:b,min:"0",max:"100"})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Categor\xeda *"}),(0,t.jsxs)("select",{name:"category",value:p.category,onChange:b,required:!0,children:[(0,t.jsx)("option",{value:"",children:"Seleccionar categor\xeda"}),a.map(e=>(0,t.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Stock *"}),(0,t.jsx)("input",{type:"number",name:"stock",value:p.stock,onChange:b,min:"0",required:!0})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"SKU"}),(0,t.jsx)("input",{type:"text",name:"sku",value:p.sku,onChange:b})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Marca"}),(0,t.jsx)("input",{type:"text",name:"brand",value:p.brand,onChange:b})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Im\xe1genes (URLs)"}),p.images.map((e,s)=>(0,t.jsxs)("div",{className:"image-input-row",children:[(0,t.jsx)("input",{type:"url",value:e,onChange:e=>((e,s)=>{const a=[...p.images];a[e]=s,g((0,r.A)((0,r.A)({},p),{},{images:a}))})(s,e.target.value),placeholder:"https://ejemplo.com/imagen.jpg"}),p.images.length>1&&(0,t.jsx)("button",{type:"button",className:"btn-remove-image",onClick:()=>(e=>{const s=p.images.filter((s,a)=>a!==e);g((0,r.A)((0,r.A)({},p),{},{images:s}))})(s),children:(0,t.jsx)(i.QCr,{})})]},s)),(0,t.jsx)("button",{type:"button",className:"btn btn-secondary btn-small",onClick:()=>{g((0,r.A)((0,r.A)({},p),{},{images:[...p.images,""]}))},children:"+ A\xf1adir imagen"})]}),(0,t.jsxs)("div",{className:"form-checkboxes",children:[(0,t.jsxs)("label",{className:"checkbox-label",children:[(0,t.jsx)("input",{type:"checkbox",name:"isOffer",checked:p.isOffer,onChange:b}),(0,t.jsx)("span",{children:"Es oferta"})]}),(0,t.jsxs)("label",{className:"checkbox-label",children:[(0,t.jsx)("input",{type:"checkbox",name:"isFeatured",checked:p.isFeatured,onChange:b}),(0,t.jsx)("span",{children:"Producto destacado"})]}),(0,t.jsxs)("label",{className:"checkbox-label",children:[(0,t.jsx)("input",{type:"checkbox",name:"active",checked:p.active,onChange:b}),(0,t.jsx)("span",{children:"Activo"})]})]}),(0,t.jsxs)("div",{className:"form-actions",children:[(0,t.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:N,children:"Cancelar"}),(0,t.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[h?"Actualizar":"Crear"," Producto"]})]})]})]})})]})}}}]);
//# sourceMappingURL=143.fe8611a6.chunk.js.map