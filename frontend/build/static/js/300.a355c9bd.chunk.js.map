{"version":3,"file":"static/js/300.a355c9bd.chunk.js","mappings":"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","sources":["components/profile/NotificationsTab.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { FaBell, FaRegEnvelope, FaRegEnvelopeOpen } from 'react-icons/fa';\r\nimport '../../styles/Profile.css';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\nconst NotificationsTab = () => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const loadNotifs = async () => {\r\n      try {\r\n        const token = sessionStorage.getItem('token');\r\n        if (!token) {\r\n          setError('No estás autenticado. Por favor, inicia sesión.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        const res = await axios.get(`${API_URL}/notifications/my-notifications`, { // ✅ Fix: ruta correcta\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n\r\n        const notifs = Array.isArray(res.data) ? res.data : []; // ✅ Fix: array directo\r\n        setNotifications(notifs);\r\n      } catch (err) {\r\n        if (err.response?.status === 401) {\r\n          setError('Tu sesión ha expirado. Por favor, vuelve a iniciar sesión.');\r\n        } else if (err.response?.status === 404) {\r\n          setNotifications([]);\r\n        } else {\r\n          setError('Error al cargar notificaciones. Intenta recargar la página.');\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    loadNotifs();\r\n  }, []);\r\n\r\n  const markAsRead = async (notificationId) => {\r\n    try {\r\n      const token = sessionStorage.getItem('token');\r\n      await axios.put(\r\n        `${API_URL}/notifications/${notificationId}/read`,\r\n        {},\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      setNotifications(prev =>\r\n        prev.map(n => n._id === notificationId ? { ...n, read: true } : n)\r\n      );\r\n    } catch (err) {\r\n      console.error('Error al marcar como leída:', err);\r\n    }\r\n  };\r\n\r\n  if (loading) return <div className=\"tab-loading\">Buscando nuevos mensajes...</div>;\r\n\r\n  if (error) return (\r\n    <div className=\"empty-state\">\r\n      <FaBell size={40} />\r\n      <h3>Error</h3>\r\n      <p>{error}</p>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"notifications-tab\">\r\n      <div className=\"tab-header\">\r\n        <h2>Notificaciones</h2>\r\n        {notifications.length > 0 && (\r\n          <span className=\"notif-count\">\r\n            {notifications.filter(n => !n.read).length} sin leer\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {notifications.length === 0 ? (\r\n        <div className=\"empty-state\">\r\n          <FaBell size={40} />\r\n          <p>No tienes mensajes nuevos por ahora.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"notif-list\">\r\n          {notifications.map(n => (\r\n            <div\r\n              key={n._id}\r\n              className={`notif-card ${n.read ? 'read' : 'unread'}`}\r\n              onClick={() => !n.read && markAsRead(n._id)}\r\n              style={{ cursor: !n.read ? 'pointer' : 'default' }}\r\n            >\r\n              <div className=\"notif-icon\">\r\n                {n.read ? <FaRegEnvelopeOpen /> : <FaRegEnvelope />}\r\n              </div>\r\n              <div className=\"notif-info\">\r\n                <h4>{n.title}</h4>\r\n                <p>{n.message}</p>\r\n                <small>{new Date(n.createdAt).toLocaleString('es-ES', {\r\n                  year: 'numeric', month: 'short', day: 'numeric',\r\n                  hour: '2-digit', minute: '2-digit'\r\n                })}</small>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationsTab;"],"names":["API_URL","process","REACT_APP_API_URL","NotificationsTab","notifications","setNotifications","useState","loading","setLoading","error","setError","useEffect","async","token","sessionStorage","getItem","res","axios","get","concat","headers","Authorization","notifs","Array","isArray","data","err","_err$response","_err$response2","response","status","loadNotifs","_jsx","className","children","_jsxs","FaBell","size","length","filter","n","read","map","onClick","put","notificationId","prev","_id","_objectSpread","console","markAsRead","style","cursor","FaRegEnvelopeOpen","FaRegEnvelope","title","message","Date","createdAt","toLocaleString","year","month","day","hour","minute"],"sourceRoot":""}