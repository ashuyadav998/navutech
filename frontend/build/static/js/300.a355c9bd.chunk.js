"use strict";(self.webpackChunksimshop_frontend=self.webpackChunksimshop_frontend||[]).push([[300],{300(e,s,a){a.r(s),a.d(s,{default:()=>d});var i=a(555),t=a(43),n=a(722),r=a(774),o=(a(463),a(579));const c={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:5000/api",d=()=>{const[e,s]=(0,t.useState)([]),[a,d]=(0,t.useState)(!0),[l,h]=(0,t.useState)(null);(0,t.useEffect)(()=>{(async()=>{try{const e=sessionStorage.getItem("token");if(!e)return h("No est\xe1s autenticado. Por favor, inicia sesi\xf3n."),void d(!1);const a=await n.A.get("".concat(c,"/notifications/my-notifications"),{headers:{Authorization:"Bearer ".concat(e)}}),i=Array.isArray(a.data)?a.data:[];s(i)}catch(i){var e,a;401===(null===(e=i.response)||void 0===e?void 0:e.status)?h("Tu sesi\xf3n ha expirado. Por favor, vuelve a iniciar sesi\xf3n."):404===(null===(a=i.response)||void 0===a?void 0:a.status)?s([]):h("Error al cargar notificaciones. Intenta recargar la p\xe1gina.")}finally{d(!1)}})()},[]);return a?(0,o.jsx)("div",{className:"tab-loading",children:"Buscando nuevos mensajes..."}):l?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)(r.jNV,{size:40}),(0,o.jsx)("h3",{children:"Error"}),(0,o.jsx)("p",{children:l})]}):(0,o.jsxs)("div",{className:"notifications-tab",children:[(0,o.jsxs)("div",{className:"tab-header",children:[(0,o.jsx)("h2",{children:"Notificaciones"}),e.length>0&&(0,o.jsxs)("span",{className:"notif-count",children:[e.filter(e=>!e.read).length," sin leer"]})]}),0===e.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)(r.jNV,{size:40}),(0,o.jsx)("p",{children:"No tienes mensajes nuevos por ahora."})]}):(0,o.jsx)("div",{className:"notif-list",children:e.map(e=>(0,o.jsxs)("div",{className:"notif-card ".concat(e.read?"read":"unread"),onClick:()=>!e.read&&(async e=>{try{const a=sessionStorage.getItem("token");await n.A.put("".concat(c,"/notifications/").concat(e,"/read"),{},{headers:{Authorization:"Bearer ".concat(a)}}),s(s=>s.map(s=>s._id===e?(0,i.A)((0,i.A)({},s),{},{read:!0}):s))}catch(a){console.error("Error al marcar como le\xedda:",a)}})(e._id),style:{cursor:e.read?"default":"pointer"},children:[(0,o.jsx)("div",{className:"notif-icon",children:e.read?(0,o.jsx)(r.GLO,{}):(0,o.jsx)(r.Wjb,{})}),(0,o.jsxs)("div",{className:"notif-info",children:[(0,o.jsx)("h4",{children:e.title}),(0,o.jsx)("p",{children:e.message}),(0,o.jsx)("small",{children:new Date(e.createdAt).toLocaleString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},e._id))})]})}},463(){}}]);
//# sourceMappingURL=300.a355c9bd.chunk.js.map