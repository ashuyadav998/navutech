{"ast":null,"code":"import _objectSpread from\"C:/Users/ashu_/Documents/ecommerce-sim/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Link,useNavigate,useLocation}from'react-router-dom';import{useAuth}from'../context/AuthContext';import axios from'axios';import'../styles/Auth.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';const Login=()=>{const navigate=useNavigate();const location=useLocation();const{login,isAuthenticated}=useAuth();const[formData,setFormData]=useState({email:'',password:''});const[error,setError]=useState('');const[loading,setLoading]=useState(false);// Si ya está autenticado, redirigir\nuseEffect(()=>{if(isAuthenticated()){var _location$state,_location$state$from;const from=((_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||'/';navigate(from,{replace:true});}},[isAuthenticated,navigate,location]);const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();setError('');setLoading(true);try{const response=await axios.post(\"\".concat(API_URL,\"/auth/login\"),formData);// Guardar sesión\nlogin(response.data.user,response.data.token);// Redirigir según el rol\nif(response.data.user.role==='admin'){navigate('/admin',{replace:true});}else{var _location$state2,_location$state2$from;// Redirigir a donde venía o al home\nconst from=((_location$state2=location.state)===null||_location$state2===void 0?void 0:(_location$state2$from=_location$state2.from)===null||_location$state2$from===void 0?void 0:_location$state2$from.pathname)||'/';navigate(from,{replace:true});}}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Error al iniciar sesión');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-card\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Iniciar Sesi\\xF3n\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",name:\"email\",value:formData.email,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",value:formData.password,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",disabled:loading,children:loading?'Iniciando sesión...':'Iniciar Sesión'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"auth-link\",children:[\"\\xBFNo tienes cuenta? \",/*#__PURE__*/_jsx(Link,{to:\"/registro\",children:\"Reg\\xEDstrate aqu\\xED\"})]})]})})});};export default Login;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","useLocation","useAuth","axios","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","Login","navigate","location","login","isAuthenticated","formData","setFormData","email","password","error","setError","loading","setLoading","_location$state","_location$state$from","from","state","pathname","replace","handleChange","e","_objectSpread","target","name","value","handleSubmit","preventDefault","response","post","concat","data","user","token","role","_location$state2","_location$state2$from","err","_err$response","_err$response$data","message","className","children","onSubmit","htmlFor","type","id","onChange","required","disabled","to"],"sources":["C:/Users/ashu_/Documents/ecommerce-sim/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport axios from 'axios';\nimport '../styles/Auth.css';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { login, isAuthenticated } = useAuth();\n  \n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  });\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Si ya está autenticado, redirigir\n  useEffect(() => {\n    if (isAuthenticated()) {\n      const from = location.state?.from?.pathname || '/';\n      navigate(from, { replace: true });\n    }\n  }, [isAuthenticated, navigate, location]);\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      const response = await axios.post(`${API_URL}/auth/login`, formData);\n      \n      // Guardar sesión\n      login(response.data.user, response.data.token);\n      \n      // Redirigir según el rol\n      if (response.data.user.role === 'admin') {\n        navigate('/admin', { replace: true });\n      } else {\n        // Redirigir a donde venía o al home\n        const from = location.state?.from?.pathname || '/';\n        navigate(from, { replace: true });\n      }\n    } catch (err) {\n      setError(err.response?.data?.message || 'Error al iniciar sesión');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"auth-page\">\n      <div className=\"container\">\n        <div className=\"auth-card\">\n          <h1>Iniciar Sesión</h1>\n\n          {error && <div className=\"error-message\">{error}</div>}\n\n          <form onSubmit={handleSubmit}>\n            <div className=\"form-group\">\n              <label htmlFor=\"email\">Email</label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"password\">Contraseña</label>\n              <input\n                type=\"password\"\n                id=\"password\"\n                name=\"password\"\n                value={formData.password}\n                onChange={handleChange}\n                required\n              />\n            </div>\n\n            <button type=\"submit\" className=\"submit-btn\" disabled={loading}>\n              {loading ? 'Iniciando sesión...' : 'Iniciar Sesión'}\n            </button>\n          </form>\n\n          <p className=\"auth-link\">\n            ¿No tienes cuenta? <Link to=\"/registro\">Regístrate aquí</Link>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}