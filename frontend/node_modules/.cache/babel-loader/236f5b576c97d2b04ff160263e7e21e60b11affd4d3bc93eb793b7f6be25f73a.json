{"ast":null,"code":"import _objectSpread from\"C:/Users/ashu_/Documents/ecommerce-sim/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{loadStripe}from'@stripe/stripe-js';import{Elements,PaymentElement,useStripe,useElements}from'@stripe/react-stripe-js';import{useCart}from'../context/CartContext';import{useAuth}from'../context/AuthContext';import axios from'axios';import'../styles/Checkout.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';const stripeKey=process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY;const stripePromise=stripeKey?loadStripe(stripeKey):null;// Validar c√≥digo postal espa√±ol\nconst validarCodigoPostal=cp=>{const regex=/^(?:0[1-9]|[1-4]\\d|5[0-2])\\d{3}$/;return regex.test(cp);};const provinciasEspana=['√Ålava','Albacete','Alicante','Almer√≠a','Asturias','√Åvila','Badajoz','Barcelona','Burgos','C√°ceres','C√°diz','Cantabria','Castell√≥n','Ciudad Real','C√≥rdoba','Cuenca','Girona','Granada','Guadalajara','Guip√∫zcoa','Huelva','Huesca','Islas Baleares','Ja√©n','La Coru√±a','La Rioja','Las Palmas','Le√≥n','Lleida','Lugo','Madrid','M√°laga','Murcia','Navarra','Ourense','Palencia','Pontevedra','Salamanca','Segovia','Sevilla','Soria','Tarragona','Santa Cruz de Tenerife','Teruel','Toledo','Valencia','Valladolid','Vizcaya','Zamora','Zaragoza'];// Componente de pago Stripe\nconst StripePaymentForm=_ref=>{let{onSuccess}=_ref;const stripe=useStripe();const elements=useElements();const[loading,setLoading]=useState(false);const[error,setError]=useState('');const handleSubmit=async e=>{e.preventDefault();if(!stripe||!elements)return;setLoading(true);setError('');try{const{error:stripeError,paymentIntent}=await stripe.confirmPayment({elements,redirect:'if_required'});if(stripeError){setError(stripeError.message);setLoading(false);return;}if(paymentIntent&&paymentIntent.status==='succeeded'){onSuccess(paymentIntent.id);}}catch(err){console.error('Error:',err);setError('Error al procesar el pago');setLoading(false);}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"payment-form\",children:[/*#__PURE__*/_jsx(PaymentElement,{}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-finalizar-compra\",disabled:!stripe||loading,children:loading?'Procesando...':'üí≥ Pagar Ahora'}),/*#__PURE__*/_jsx(\"div\",{className:\"secure-payment\",children:\"\\uD83D\\uDD12 Pago 100% seguro con Stripe\"})]});};const Checkout=()=>{const navigate=useNavigate();const{cart,getCartTotal,clearCart}=useCart();const{user,isAuthenticated}=useAuth();const[paymentMethod,setPaymentMethod]=useState('stripe');const[clientSecret,setClientSecret]=useState('');const[loading,setLoading]=useState(false);const[showStripeForm,setShowStripeForm]=useState(false);const[errors,setErrors]=useState({});const[formData,setFormData]=useState({street:'',city:'',province:'',postalCode:'',phone:'',notes:''});useEffect(()=>{if(!isAuthenticated()){navigate('/login',{state:{from:{pathname:'/checkout'}}});return;}if(!cart||cart.length===0){navigate('/carrito');return;}},[isAuthenticated,cart,navigate]);const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));if(errors[name]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:''}));}};const validateForm=()=>{const newErrors={};if(!formData.street.trim())newErrors.street='Direcci√≥n obligatoria';if(!formData.city.trim())newErrors.city='Ciudad obligatoria';if(!formData.province)newErrors.province='Selecciona provincia';if(!formData.postalCode){newErrors.postalCode='C√≥digo postal obligatorio';}else if(!validarCodigoPostal(formData.postalCode)){newErrors.postalCode='C√≥digo postal inv√°lido';}// Validaci√≥n de tel√©fono\nif(!formData.phone.trim()){newErrors.phone='Tel√©fono obligatorio';}else{const phoneRegex=/^[6-9]\\d{8}$/;if(!phoneRegex.test(formData.phone)){newErrors.phone='Tel√©fono inv√°lido (9 d√≠gitos, ej: 612345678)';}}setErrors(newErrors);return Object.keys(newErrors).length===0;};// ‚úÖ FUNCI√ìN CORREGIDA - Crear PaymentIntent solo cuando se presiona el bot√≥n\nconst handleInitiateStripePayment=async()=>{// Validar formulario primero\nif(!validateForm()){alert('Por favor, completa todos los campos correctamente antes de continuar');return;}try{setLoading(true);const token=sessionStorage.getItem('token');console.log('üîÑ Creando PaymentIntent con datos:',{items:cart.length,total:getCartTotal(),phone:formData.phone});const response=await axios.post(\"\".concat(API_URL,\"/stripe/create-payment-intent\"),{items:cart.map(item=>({product:item._id,quantity:item.quantity,price:item.price,name:item.name})),totalAmount:getCartTotal(),shippingInfo:{name:(user===null||user===void 0?void 0:user.name)||'Cliente',email:(user===null||user===void 0?void 0:user.email)||'',phone:formData.phone,address:{street:formData.street,city:formData.city,province:formData.province,postalCode:formData.postalCode,country:'Espa√±a'}}},{headers:{Authorization:\"Bearer \".concat(token)}});console.log('‚úÖ PaymentIntent creado:',response.data.clientSecret);setClientSecret(response.data.clientSecret);setShowStripeForm(true);}catch(error){var _error$response,_error$response$data,_error$response2,_error$response2$data;console.error('‚ùå Error al crear PaymentIntent:',error);const errorMsg=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Error al inicializar pago';alert(errorMsg);}finally{setLoading(false);}};const handlePaymentMethodChange=method=>{setPaymentMethod(method);setShowStripeForm(false);setClientSecret('');};const handleStripeSuccess=async paymentIntentId=>{try{const token=sessionStorage.getItem('token');console.log('‚úÖ Confirmando pago con PaymentIntent:',paymentIntentId);const response=await axios.post(\"\".concat(API_URL,\"/stripe/confirm-payment\"),{paymentIntentId,cartItems:cart.map(item=>({product:item._id,productId:item._id,quantity:item.quantity,price:item.price,name:item.name})),totalAmount:getCartTotal(),shippingInfo:{name:(user===null||user===void 0?void 0:user.name)||'Cliente',email:(user===null||user===void 0?void 0:user.email)||'',phone:formData.phone,address:{street:formData.street,city:formData.city,province:formData.province,postalCode:formData.postalCode,country:'Espa√±a'}},shippingAddress:{street:formData.street,city:formData.city,province:formData.province,postalCode:formData.postalCode,country:'Espa√±a'},phone:formData.phone,notes:formData.notes},{headers:{Authorization:\"Bearer \".concat(token)}});console.log('‚úÖ Pedido confirmado:',response.data);clearCart();alert('¬°Pago realizado con √©xito!');navigate('/perfil');}catch(error){var _error$response3,_error$response3$data,_error$response4,_error$response4$data;console.error('‚ùå Error al confirmar pedido:',error);const errorMessage=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.details)||'Error al confirmar pedido';alert(errorMessage);if(errorMessage.includes('phone')){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{phone:'El tel√©fono es requerido'}));}}};const handleOtherPaymentMethod=async()=>{if(!validateForm()){alert('Por favor, completa todos los campos correctamente');return;}try{setLoading(true);const token=sessionStorage.getItem('token');const orderData={items:cart.map(item=>({product:item._id,quantity:item.quantity,price:item.price,name:item.name})),totalAmount:paymentMethod==='contrareembolso'?getCartTotal()+3:getCartTotal(),shippingAddress:{street:formData.street,city:formData.city,province:formData.province,postalCode:formData.postalCode,country:'Espa√±a'},name:(user===null||user===void 0?void 0:user.name)||'Cliente',email:(user===null||user===void 0?void 0:user.email)||'',phone:formData.phone,paymentMethod,notes:formData.notes};console.log('üì¶ Creando pedido:',orderData);const response=await axios.post(\"\".concat(API_URL,\"/orders\"),orderData,{headers:{Authorization:\"Bearer \".concat(token)}});console.log('‚úÖ Pedido creado:',response.data);clearCart();alert('¬°Pedido realizado con √©xito!');navigate('/perfil');}catch(error){var _error$response5,_error$response5$data,_error$response6,_error$response6$data;console.error('‚ùå Error al crear pedido:',error);alert(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.message)||'Error al crear pedido');}finally{setLoading(false);}};const formatPrice=price=>{return new Intl.NumberFormat('es-ES',{style:'currency',currency:'EUR'}).format(price);};if(!cart||cart.length===0){return null;}return/*#__PURE__*/_jsx(\"div\",{className:\"checkout-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Finalizar Compra\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-layout\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCCD Direcci\\xF3n de Env\\xEDo\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Direcci\\xF3n *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"street\",value:formData.street,onChange:handleInputChange,placeholder:\"Calle, n\\xFAmero, piso...\",className:errors.street?'error':''}),errors.street&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.street})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Ciudad *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"city\",value:formData.city,onChange:handleInputChange,className:errors.city?'error':''}),errors.city&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.city})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"C\\xF3digo Postal *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"postalCode\",value:formData.postalCode,onChange:handleInputChange,placeholder:\"28001\",maxLength:\"5\",className:errors.postalCode?'error':''}),errors.postalCode&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.postalCode})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Provincia *\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"province\",value:formData.province,onChange:handleInputChange,className:errors.province?'error':'',children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona provincia\"}),provinciasEspana.map(p=>/*#__PURE__*/_jsx(\"option\",{value:p,children:p},p))]}),errors.province&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.province})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Tel\\xE9fono * \",/*#__PURE__*/_jsx(\"small\",{children:\"(Necesario para la entrega)\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",value:formData.phone,onChange:handleInputChange,placeholder:\"612345678\",maxLength:\"9\",className:errors.phone?'error':''}),errors.phone&&/*#__PURE__*/_jsx(\"span\",{className:\"error-text\",children:errors.phone}),/*#__PURE__*/_jsx(\"small\",{className:\"help-text\",children:\"\\uD83D\\uDCF1 9 d\\xEDgitos comenzando por 6, 7, 8 o 9 (sin espacios ni guiones)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Notas (opcional)\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"notes\",value:formData.notes,onChange:handleInputChange,rows:\"3\",placeholder:\"Instrucciones especiales...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"checkout-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCB3 M\\xE9todo de Pago\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-methods\",children:[stripePromise&&/*#__PURE__*/_jsxs(\"button\",{className:\"payment-method-btn \".concat(paymentMethod==='stripe'?'active':''),onClick:()=>handlePaymentMethodChange('stripe'),type:\"button\",disabled:showStripeForm,children:[/*#__PURE__*/_jsx(\"span\",{className:\"payment-icon\",children:\"\\uD83D\\uDCB3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Tarjeta\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"payment-method-btn \".concat(paymentMethod==='bizum'?'active':''),onClick:()=>handlePaymentMethodChange('bizum'),type:\"button\",disabled:showStripeForm,children:[/*#__PURE__*/_jsx(\"span\",{className:\"payment-icon\",children:\"\\uD83D\\uDCF1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Bizum\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"payment-method-btn \".concat(paymentMethod==='transferencia'?'active':''),onClick:()=>handlePaymentMethodChange('transferencia'),type:\"button\",disabled:showStripeForm,children:[/*#__PURE__*/_jsx(\"span\",{className:\"payment-icon\",children:\"\\uD83C\\uDFE6\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Transferencia\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"payment-method-btn \".concat(paymentMethod==='contrareembolso'?'active':''),onClick:()=>handlePaymentMethodChange('contrareembolso'),type:\"button\",disabled:showStripeForm,children:[/*#__PURE__*/_jsx(\"span\",{className:\"payment-icon\",children:\"\\uD83D\\uDCB5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Contrareembolso (+3\\u20AC)\"})]})]}),paymentMethod==='stripe'&&!showStripeForm&&/*#__PURE__*/_jsxs(\"div\",{className:\"payment-init-section\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"payment-info\",children:\"\\u2139\\uFE0F Completa tu direcci\\xF3n de env\\xEDo y haz clic en continuar para procesar el pago\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-finalizar-compra\",onClick:handleInitiateStripePayment,disabled:loading,children:loading?'Preparando pago...':'‚ñ∂Ô∏è Continuar con Tarjeta'})]}),paymentMethod==='stripe'&&showStripeForm&&clientSecret&&stripePromise&&/*#__PURE__*/_jsx(\"div\",{className:\"stripe-form-container\",children:/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,options:{clientSecret},children:/*#__PURE__*/_jsx(StripePaymentForm,{onSuccess:handleStripeSuccess})})}),paymentMethod!=='stripe'&&/*#__PURE__*/_jsxs(\"div\",{className:\"other-payment-section\",children:[paymentMethod==='bizum'&&/*#__PURE__*/_jsx(\"p\",{className:\"payment-info\",children:\"\\uD83D\\uDCF1 Recibir\\xE1s instrucciones de pago por email\"}),paymentMethod==='transferencia'&&/*#__PURE__*/_jsx(\"p\",{className:\"payment-info\",children:\"\\uD83C\\uDFE6 Recibir\\xE1s los datos bancarios por email\"}),paymentMethod==='contrareembolso'&&/*#__PURE__*/_jsx(\"p\",{className:\"payment-info\",children:\"\\uD83D\\uDCB5 Pagar\\xE1s al recibir el pedido (+3\\u20AC de coste)\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-finalizar-compra\",onClick:handleOtherPaymentMethod,disabled:loading,children:loading?'Procesando...':'‚úÖ Confirmar Pedido'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-summary\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Resumen\"}),/*#__PURE__*/_jsx(\"div\",{className:\"order-items\",children:cart.map(item=>{var _item$images;return/*#__PURE__*/_jsxs(\"div\",{className:\"order-item\",children:[/*#__PURE__*/_jsx(\"img\",{src:((_item$images=item.images)===null||_item$images===void 0?void 0:_item$images[0])||'/placeholder.jpg',alt:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"item-name\",children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"item-qty\",children:[\"Cantidad: \",item.quantity]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"item-price\",children:formatPrice(item.price*item.quantity)})]},item._id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-totals\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal\"}),/*#__PURE__*/_jsx(\"span\",{children:formatPrice(getCartTotal())})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Env\\xEDo\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Gratis\"})]}),paymentMethod==='contrareembolso'&&/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Contrareembolso\"}),/*#__PURE__*/_jsx(\"span\",{children:\"3,00 \\u20AC\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row total\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total\"}),/*#__PURE__*/_jsx(\"span\",{children:formatPrice(paymentMethod==='contrareembolso'?getCartTotal()+3:getCartTotal())})]})]})]})]})]})});};export default Checkout;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","loadStripe","Elements","PaymentElement","useStripe","useElements","useCart","useAuth","axios","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","stripeKey","REACT_APP_STRIPE_PUBLISHABLE_KEY","stripePromise","validarCodigoPostal","cp","regex","test","provinciasEspana","StripePaymentForm","_ref","onSuccess","stripe","elements","loading","setLoading","error","setError","handleSubmit","e","preventDefault","stripeError","paymentIntent","confirmPayment","redirect","message","status","id","err","console","onSubmit","className","children","type","disabled","Checkout","navigate","cart","getCartTotal","clearCart","user","isAuthenticated","paymentMethod","setPaymentMethod","clientSecret","setClientSecret","showStripeForm","setShowStripeForm","errors","setErrors","formData","setFormData","street","city","province","postalCode","phone","notes","state","from","pathname","length","handleInputChange","name","value","target","prev","_objectSpread","validateForm","newErrors","trim","phoneRegex","Object","keys","handleInitiateStripePayment","alert","token","sessionStorage","getItem","log","items","total","response","post","concat","map","item","product","_id","quantity","price","totalAmount","shippingInfo","email","address","country","headers","Authorization","data","_error$response","_error$response$data","_error$response2","_error$response2$data","errorMsg","handlePaymentMethodChange","method","handleStripeSuccess","paymentIntentId","cartItems","productId","shippingAddress","_error$response3","_error$response3$data","_error$response4","_error$response4$data","errorMessage","details","includes","handleOtherPaymentMethod","orderData","_error$response5","_error$response5$data","_error$response6","_error$response6$data","formatPrice","Intl","NumberFormat","style","currency","format","onChange","placeholder","maxLength","p","rows","onClick","options","_item$images","src","images","alt"],"sources":["C:/Users/ashu_/Documents/ecommerce-sim/frontend/src/pages/Checkout.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { Elements, PaymentElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport { useCart } from '../context/CartContext';\nimport { useAuth } from '../context/AuthContext';\nimport axios from 'axios';\nimport '../styles/Checkout.css';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\nconst stripeKey = process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY;\nconst stripePromise = stripeKey ? loadStripe(stripeKey) : null;\n\n// Validar c√≥digo postal espa√±ol\nconst validarCodigoPostal = (cp) => {\n  const regex = /^(?:0[1-9]|[1-4]\\d|5[0-2])\\d{3}$/;\n  return regex.test(cp);\n};\n\nconst provinciasEspana = [\n  '√Ålava', 'Albacete', 'Alicante', 'Almer√≠a', 'Asturias', '√Åvila', 'Badajoz', \n  'Barcelona', 'Burgos', 'C√°ceres', 'C√°diz', 'Cantabria', 'Castell√≥n', 'Ciudad Real',\n  'C√≥rdoba', 'Cuenca', 'Girona', 'Granada', 'Guadalajara', 'Guip√∫zcoa', 'Huelva',\n  'Huesca', 'Islas Baleares', 'Ja√©n', 'La Coru√±a', 'La Rioja', 'Las Palmas', 'Le√≥n',\n  'Lleida', 'Lugo', 'Madrid', 'M√°laga', 'Murcia', 'Navarra', 'Ourense', 'Palencia',\n  'Pontevedra', 'Salamanca', 'Segovia', 'Sevilla', 'Soria', 'Tarragona', \n  'Santa Cruz de Tenerife', 'Teruel', 'Toledo', 'Valencia', 'Valladolid', \n  'Vizcaya', 'Zamora', 'Zaragoza'\n];\n\n// Componente de pago Stripe\nconst StripePaymentForm = ({ onSuccess }) => {\n  const stripe = useStripe();\n  const elements = useElements();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n\n    setLoading(true);\n    setError('');\n\n    try {\n      const { error: stripeError, paymentIntent } = await stripe.confirmPayment({\n        elements,\n        redirect: 'if_required'\n      });\n\n      if (stripeError) {\n        setError(stripeError.message);\n        setLoading(false);\n        return;\n      }\n\n      if (paymentIntent && paymentIntent.status === 'succeeded') {\n        onSuccess(paymentIntent.id);\n      }\n    } catch (err) {\n      console.error('Error:', err);\n      setError('Error al procesar el pago');\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"payment-form\">\n      <PaymentElement />\n      {error && <div className=\"error-message\">{error}</div>}\n      <button \n        type=\"submit\" \n        className=\"btn-finalizar-compra\" \n        disabled={!stripe || loading}\n      >\n        {loading ? 'Procesando...' : 'üí≥ Pagar Ahora'}\n      </button>\n      <div className=\"secure-payment\">üîí Pago 100% seguro con Stripe</div>\n    </form>\n  );\n};\n\nconst Checkout = () => {\n  const navigate = useNavigate();\n  const { cart, getCartTotal, clearCart } = useCart();\n  const { user, isAuthenticated } = useAuth();\n  \n  const [paymentMethod, setPaymentMethod] = useState('stripe');\n  const [clientSecret, setClientSecret] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [showStripeForm, setShowStripeForm] = useState(false);\n  const [errors, setErrors] = useState({});\n  const [formData, setFormData] = useState({\n    street: '',\n    city: '',\n    province: '',\n    postalCode: '',\n    phone: '',\n    notes: ''\n  });\n\n  useEffect(() => {\n    if (!isAuthenticated()) {\n      navigate('/login', { state: { from: { pathname: '/checkout' } } });\n      return;\n    }\n\n    if (!cart || cart.length === 0) {\n      navigate('/carrito');\n      return;\n    }\n  }, [isAuthenticated, cart, navigate]);\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const validateForm = () => {\n    const newErrors = {};\n\n    if (!formData.street.trim()) newErrors.street = 'Direcci√≥n obligatoria';\n    if (!formData.city.trim()) newErrors.city = 'Ciudad obligatoria';\n    if (!formData.province) newErrors.province = 'Selecciona provincia';\n    \n    if (!formData.postalCode) {\n      newErrors.postalCode = 'C√≥digo postal obligatorio';\n    } else if (!validarCodigoPostal(formData.postalCode)) {\n      newErrors.postalCode = 'C√≥digo postal inv√°lido';\n    }\n\n    // Validaci√≥n de tel√©fono\n    if (!formData.phone.trim()) {\n      newErrors.phone = 'Tel√©fono obligatorio';\n    } else {\n      const phoneRegex = /^[6-9]\\d{8}$/;\n      if (!phoneRegex.test(formData.phone)) {\n        newErrors.phone = 'Tel√©fono inv√°lido (9 d√≠gitos, ej: 612345678)';\n      }\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  // ‚úÖ FUNCI√ìN CORREGIDA - Crear PaymentIntent solo cuando se presiona el bot√≥n\n  const handleInitiateStripePayment = async () => {\n    // Validar formulario primero\n    if (!validateForm()) {\n      alert('Por favor, completa todos los campos correctamente antes de continuar');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const token = sessionStorage.getItem('token');\n      \n      console.log('üîÑ Creando PaymentIntent con datos:', {\n        items: cart.length,\n        total: getCartTotal(),\n        phone: formData.phone\n      });\n\n      const response = await axios.post(\n        `${API_URL}/stripe/create-payment-intent`,\n        {\n          items: cart.map(item => ({\n            product: item._id,\n            quantity: item.quantity,\n            price: item.price,\n            name: item.name\n          })),\n          totalAmount: getCartTotal(),\n          shippingInfo: {\n            name: user?.name || 'Cliente',\n            email: user?.email || '',\n            phone: formData.phone,\n            address: {\n              street: formData.street,\n              city: formData.city,\n              province: formData.province,\n              postalCode: formData.postalCode,\n              country: 'Espa√±a'\n            }\n          }\n        },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      console.log('‚úÖ PaymentIntent creado:', response.data.clientSecret);\n      setClientSecret(response.data.clientSecret);\n      setShowStripeForm(true);\n    } catch (error) {\n      console.error('‚ùå Error al crear PaymentIntent:', error);\n      const errorMsg = error.response?.data?.error || \n                       error.response?.data?.message || \n                       'Error al inicializar pago';\n      alert(errorMsg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePaymentMethodChange = (method) => {\n    setPaymentMethod(method);\n    setShowStripeForm(false);\n    setClientSecret('');\n  };\n\n  const handleStripeSuccess = async (paymentIntentId) => {\n    try {\n      const token = sessionStorage.getItem('token');\n      \n      console.log('‚úÖ Confirmando pago con PaymentIntent:', paymentIntentId);\n\n      const response = await axios.post(\n        `${API_URL}/stripe/confirm-payment`,\n        {\n          paymentIntentId,\n          cartItems: cart.map(item => ({\n            product: item._id,\n            productId: item._id,\n            quantity: item.quantity,\n            price: item.price,\n            name: item.name\n          })),\n          totalAmount: getCartTotal(),\n          shippingInfo: {\n            name: user?.name || 'Cliente',\n            email: user?.email || '',\n            phone: formData.phone,\n            address: {\n              street: formData.street,\n              city: formData.city,\n              province: formData.province,\n              postalCode: formData.postalCode,\n              country: 'Espa√±a'\n            }\n          },\n          shippingAddress: {\n            street: formData.street,\n            city: formData.city,\n            province: formData.province,\n            postalCode: formData.postalCode,\n            country: 'Espa√±a'\n          },\n          phone: formData.phone,\n          notes: formData.notes\n        },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      console.log('‚úÖ Pedido confirmado:', response.data);\n\n      clearCart();\n      alert('¬°Pago realizado con √©xito!');\n      navigate('/perfil');\n    } catch (error) {\n      console.error('‚ùå Error al confirmar pedido:', error);\n      \n      const errorMessage = error.response?.data?.error || \n                          error.response?.data?.details || \n                          'Error al confirmar pedido';\n      \n      alert(errorMessage);\n      \n      if (errorMessage.includes('phone')) {\n        setErrors(prev => ({ ...prev, phone: 'El tel√©fono es requerido' }));\n      }\n    }\n  };\n\n  const handleOtherPaymentMethod = async () => {\n    if (!validateForm()) {\n      alert('Por favor, completa todos los campos correctamente');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      const token = sessionStorage.getItem('token');\n\n      const orderData = {\n        items: cart.map(item => ({\n          product: item._id,\n          quantity: item.quantity,\n          price: item.price,\n          name: item.name\n        })),\n        totalAmount: paymentMethod === 'contrareembolso' ? getCartTotal() + 3 : getCartTotal(),\n        shippingAddress: {\n          street: formData.street,\n          city: formData.city,\n          province: formData.province,\n          postalCode: formData.postalCode,\n          country: 'Espa√±a'\n        },\n        name: user?.name || 'Cliente',\n        email: user?.email || '',\n        phone: formData.phone,\n        paymentMethod,\n        notes: formData.notes\n      };\n\n      console.log('üì¶ Creando pedido:', orderData);\n\n      const response = await axios.post(\n        `${API_URL}/orders`,\n        orderData,\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      console.log('‚úÖ Pedido creado:', response.data);\n\n      clearCart();\n      alert('¬°Pedido realizado con √©xito!');\n      navigate('/perfil');\n    } catch (error) {\n      console.error('‚ùå Error al crear pedido:', error);\n      alert(error.response?.data?.error || error.response?.data?.message || 'Error al crear pedido');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatPrice = (price) => {\n    return new Intl.NumberFormat('es-ES', {\n      style: 'currency',\n      currency: 'EUR'\n    }).format(price);\n  };\n\n  if (!cart || cart.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"checkout-page\">\n      <div className=\"container\">\n        <h1>Finalizar Compra</h1>\n\n        <div className=\"checkout-layout\">\n          <div className=\"checkout-main\">\n            {/* Direcci√≥n */}\n            <div className=\"checkout-section\">\n              <h2>üìç Direcci√≥n de Env√≠o</h2>\n              \n              <div className=\"form-group\">\n                <label>Direcci√≥n *</label>\n                <input\n                  type=\"text\"\n                  name=\"street\"\n                  value={formData.street}\n                  onChange={handleInputChange}\n                  placeholder=\"Calle, n√∫mero, piso...\"\n                  className={errors.street ? 'error' : ''}\n                />\n                {errors.street && <span className=\"error-text\">{errors.street}</span>}\n              </div>\n\n              <div className=\"form-row\">\n                <div className=\"form-group\">\n                  <label>Ciudad *</label>\n                  <input\n                    type=\"text\"\n                    name=\"city\"\n                    value={formData.city}\n                    onChange={handleInputChange}\n                    className={errors.city ? 'error' : ''}\n                  />\n                  {errors.city && <span className=\"error-text\">{errors.city}</span>}\n                </div>\n\n                <div className=\"form-group\">\n                  <label>C√≥digo Postal *</label>\n                  <input\n                    type=\"text\"\n                    name=\"postalCode\"\n                    value={formData.postalCode}\n                    onChange={handleInputChange}\n                    placeholder=\"28001\"\n                    maxLength=\"5\"\n                    className={errors.postalCode ? 'error' : ''}\n                  />\n                  {errors.postalCode && <span className=\"error-text\">{errors.postalCode}</span>}\n                </div>\n              </div>\n\n              <div className=\"form-group\">\n                <label>Provincia *</label>\n                <select\n                  name=\"province\"\n                  value={formData.province}\n                  onChange={handleInputChange}\n                  className={errors.province ? 'error' : ''}\n                >\n                  <option value=\"\">Selecciona provincia</option>\n                  {provinciasEspana.map(p => <option key={p} value={p}>{p}</option>)}\n                </select>\n                {errors.province && <span className=\"error-text\">{errors.province}</span>}\n              </div>\n\n              <div className=\"form-group\">\n                <label>Tel√©fono * <small>(Necesario para la entrega)</small></label>\n                <input\n                  type=\"tel\"\n                  name=\"phone\"\n                  value={formData.phone}\n                  onChange={handleInputChange}\n                  placeholder=\"612345678\"\n                  maxLength=\"9\"\n                  className={errors.phone ? 'error' : ''}\n                />\n                {errors.phone && <span className=\"error-text\">{errors.phone}</span>}\n                <small className=\"help-text\">\n                  üì± 9 d√≠gitos comenzando por 6, 7, 8 o 9 (sin espacios ni guiones)\n                </small>\n              </div>\n\n              <div className=\"form-group\">\n                <label>Notas (opcional)</label>\n                <textarea\n                  name=\"notes\"\n                  value={formData.notes}\n                  onChange={handleInputChange}\n                  rows=\"3\"\n                  placeholder=\"Instrucciones especiales...\"\n                />\n              </div>\n            </div>\n\n            {/* M√©todos de pago */}\n            <div className=\"checkout-section\">\n              <h2>üí≥ M√©todo de Pago</h2>\n\n              <div className=\"payment-methods\">\n                {stripePromise && (\n                  <button\n                    className={`payment-method-btn ${paymentMethod === 'stripe' ? 'active' : ''}`}\n                    onClick={() => handlePaymentMethodChange('stripe')}\n                    type=\"button\"\n                    disabled={showStripeForm}\n                  >\n                    <span className=\"payment-icon\">üí≥</span>\n                    <span>Tarjeta</span>\n                  </button>\n                )}\n\n                <button\n                  className={`payment-method-btn ${paymentMethod === 'bizum' ? 'active' : ''}`}\n                  onClick={() => handlePaymentMethodChange('bizum')}\n                  type=\"button\"\n                  disabled={showStripeForm}\n                >\n                  <span className=\"payment-icon\">üì±</span>\n                  <span>Bizum</span>\n                </button>\n\n                <button\n                  className={`payment-method-btn ${paymentMethod === 'transferencia' ? 'active' : ''}`}\n                  onClick={() => handlePaymentMethodChange('transferencia')}\n                  type=\"button\"\n                  disabled={showStripeForm}\n                >\n                  <span className=\"payment-icon\">üè¶</span>\n                  <span>Transferencia</span>\n                </button>\n\n                <button\n                  className={`payment-method-btn ${paymentMethod === 'contrareembolso' ? 'active' : ''}`}\n                  onClick={() => handlePaymentMethodChange('contrareembolso')}\n                  type=\"button\"\n                  disabled={showStripeForm}\n                >\n                  <span className=\"payment-icon\">üíµ</span>\n                  <span>Contrareembolso (+3‚Ç¨)</span>\n                </button>\n              </div>\n\n              {/* Bot√≥n para iniciar pago con Stripe */}\n              {paymentMethod === 'stripe' && !showStripeForm && (\n                <div className=\"payment-init-section\">\n                  <p className=\"payment-info\">\n                    ‚ÑπÔ∏è Completa tu direcci√≥n de env√≠o y haz clic en continuar para procesar el pago\n                  </p>\n                  <button \n                    className=\"btn-finalizar-compra\"\n                    onClick={handleInitiateStripePayment}\n                    disabled={loading}\n                  >\n                    {loading ? 'Preparando pago...' : '‚ñ∂Ô∏è Continuar con Tarjeta'}\n                  </button>\n                </div>\n              )}\n\n              {/* Formulario Stripe */}\n              {paymentMethod === 'stripe' && showStripeForm && clientSecret && stripePromise && (\n                <div className=\"stripe-form-container\">\n                  <Elements stripe={stripePromise} options={{ clientSecret }}>\n                    <StripePaymentForm onSuccess={handleStripeSuccess} />\n                  </Elements>\n                </div>\n              )}\n\n              {/* Otros m√©todos */}\n              {paymentMethod !== 'stripe' && (\n                <div className=\"other-payment-section\">\n                  {paymentMethod === 'bizum' && (\n                    <p className=\"payment-info\">üì± Recibir√°s instrucciones de pago por email</p>\n                  )}\n                  {paymentMethod === 'transferencia' && (\n                    <p className=\"payment-info\">üè¶ Recibir√°s los datos bancarios por email</p>\n                  )}\n                  {paymentMethod === 'contrareembolso' && (\n                    <p className=\"payment-info\">üíµ Pagar√°s al recibir el pedido (+3‚Ç¨ de coste)</p>\n                  )}\n                  <button \n                    className=\"btn-finalizar-compra\"\n                    onClick={handleOtherPaymentMethod}\n                    disabled={loading}\n                  >\n                    {loading ? 'Procesando...' : '‚úÖ Confirmar Pedido'}\n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Resumen */}\n          <div className=\"order-summary\">\n            <h2>Resumen</h2>\n            <div className=\"order-items\">\n              {cart.map(item => (\n                <div key={item._id} className=\"order-item\">\n                  <img src={item.images?.[0] || '/placeholder.jpg'} alt={item.name} />\n                  <div className=\"item-details\">\n                    <p className=\"item-name\">{item.name}</p>\n                    <p className=\"item-qty\">Cantidad: {item.quantity}</p>\n                  </div>\n                  <p className=\"item-price\">{formatPrice(item.price * item.quantity)}</p>\n                </div>\n              ))}\n            </div>\n            <div className=\"summary-totals\">\n              <div className=\"summary-row\">\n                <span>Subtotal</span>\n                <span>{formatPrice(getCartTotal())}</span>\n              </div>\n              <div className=\"summary-row\">\n                <span>Env√≠o</span>\n                <span>Gratis</span>\n              </div>\n              {paymentMethod === 'contrareembolso' && (\n                <div className=\"summary-row\">\n                  <span>Contrareembolso</span>\n                  <span>3,00 ‚Ç¨</span>\n                </div>\n              )}\n              <div className=\"summary-row total\">\n                <span>Total</span>\n                <span>{formatPrice(paymentMethod === 'contrareembolso' ? getCartTotal() + 3 : getCartTotal())}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Checkout;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}