{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ashu_\\\\Documents\\\\ecommerce-sim\\\\frontend\\\\src\\\\pages\\\\admin\\\\AdminOrders.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { FaEye, FaEdit, FaPhone, FaDownload } from 'react-icons/fa';\nimport axios from 'axios';\nimport '../../styles/AdminOrders.css';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AdminOrders = () => {\n  _s();\n  var _selectedOrder$user, _selectedOrder$shippi, _selectedOrder$shippi2, _selectedOrder$shippi3, _selectedOrder$shippi4, _selectedOrder$tracki, _selectedOrder$items, _selectedOrder$items2;\n  const [orders, setOrders] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [selectedOrder, setSelectedOrder] = useState(null);\n  const [showDetailModal, setShowDetailModal] = useState(false);\n  const [statusUpdate, setStatusUpdate] = useState({\n    orderStatus: '',\n    paymentStatus: ''\n  });\n  const [error, setError] = useState(null);\n  const notifiedOrders = useRef(new Set());\n  const isFirstLoad = useRef(true);\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n  useEffect(() => {\n    loadOrders(true);\n    if (Notification.permission === 'default') Notification.requestPermission();\n    const interval = setInterval(() => loadOrders(false), 10000); // ‚úÖ 10s en vez de 30s\n    return () => clearInterval(interval);\n  }, []);\n  useEffect(() => {\n    const newOrders = orders.filter(o => !notifiedOrders.current.has(o._id) && o.orderStatus === 'pendiente');\n    if (newOrders.length > 0 && !isFirstLoad.current) {\n      newOrders.forEach(o => notifiedOrders.current.add(o._id));\n      handleNewOrderNotification(newOrders);\n    }\n  }, [orders]);\n\n  // ‚úÖ NUEVO: Actualizar statusUpdate cuando selectedOrder cambie\n  useEffect(() => {\n    if (selectedOrder) {\n      setStatusUpdate({\n        orderStatus: selectedOrder.orderStatus,\n        paymentStatus: selectedOrder.paymentStatus\n      });\n    }\n  }, [selectedOrder]);\n  const handleNewOrderNotification = newOrders => {\n    const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3');\n    audio.play().catch(() => {});\n    newOrders.forEach(order => {\n      var _order$user;\n      toast.success(`üîî ¬°NUEVO PEDIDO! #${order._id.slice(-6).toUpperCase()}\\nCliente: ${((_order$user = order.user) === null || _order$user === void 0 ? void 0 : _order$user.name) || 'Desconocido'}\\nTotal: ${formatPrice(order.totalAmount)}`, {\n        position: 'top-right',\n        autoClose: 8000\n      });\n    });\n    if (navigator.vibrate) navigator.vibrate([200, 100, 200]);\n    if (Notification.permission === 'granted') {\n      new Notification('üõí Nuevo pedido recibido', {\n        body: `${newOrders.length} pedido(s) nuevo(s)`,\n        icon: '/logo192.png'\n      });\n    }\n  };\n  const loadOrders = async (initial = false) => {\n    try {\n      if (initial) setLoading(true);\n      setRefreshing(true);\n      setError(null);\n      const token = sessionStorage.getItem('token');\n      if (!token) {\n        setError('No est√°s autenticado.');\n        setLoading(false);\n        return;\n      }\n      const response = await axios.get(`${API_URL}/orders`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const ordersData = Array.isArray(response.data) ? response.data : [];\n      setOrders(ordersData);\n      if (initial) {\n        ordersData.forEach(o => notifiedOrders.current.add(o._id));\n        isFirstLoad.current = false;\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      if (initial) setError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Error al cargar los pedidos');\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  };\n  const downloadLabel = async order => {\n    try {\n      var _order$tracking;\n      const trackingNumber = (_order$tracking = order.tracking) === null || _order$tracking === void 0 ? void 0 : _order$tracking.trackingNumber;\n      if (!trackingNumber) {\n        toast.error('Etiqueta a√∫n no disponible, pulsa Actualizar en unos segundos');\n        return;\n      }\n      const token = sessionStorage.getItem('token');\n      if (!token) {\n        toast.error('Sesi√≥n expirada');\n        return;\n      }\n      const loadingToast = toast.loading('Descargando etiqueta...');\n      const response = await axios({\n        method: 'GET',\n        url: `${API_URL}/tracking/${trackingNumber}/label`,\n        headers: {\n          Authorization: `Bearer ${token}`\n        },\n        responseType: 'blob'\n      });\n      toast.update(loadingToast, {\n        render: '‚úÖ Descargando...',\n        type: 'success',\n        isLoading: false,\n        autoClose: 1000\n      });\n      const blob = new Blob([response.data], {\n        type: 'application/pdf'\n      });\n      const url = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `etiqueta-${trackingNumber}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (err) {\n      var _err$response, _err$response2;\n      const msg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 404 ? 'Etiqueta a√∫n no disponible' : ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.status) === 401 ? 'Sesi√≥n expirada' : 'Error al descargar la etiqueta';\n      toast.error(msg);\n    }\n  };\n  const viewLabel = order => {\n    var _order$tracking2;\n    const trackingNumber = (_order$tracking2 = order.tracking) === null || _order$tracking2 === void 0 ? void 0 : _order$tracking2.trackingNumber;\n    if (!trackingNumber) {\n      toast.error('Sin etiqueta disponible');\n      return;\n    }\n    const token = sessionStorage.getItem('token');\n    window.open(`${API_URL}/tracking/${trackingNumber}/label/preview?token=${token}`, '_blank');\n  };\n  const formatPrice = price => new Intl.NumberFormat('es-ES', {\n    style: 'currency',\n    currency: 'EUR'\n  }).format(price);\n  const getStatusBadge = status => ({\n    pendiente: 'badge-warning',\n    procesando: 'badge-info',\n    enviado: 'badge-primary',\n    entregado: 'badge-success',\n    cancelado: 'badge-danger',\n    pagado: 'badge-success',\n    fallido: 'badge-danger'\n  })[status] || 'badge-secondary';\n  const getStatusLabel = status => ({\n    pendiente: 'Pendiente',\n    procesando: 'Procesando',\n    enviado: 'Enviado',\n    entregado: 'Entregado',\n    cancelado: 'Cancelado',\n    pagado: 'Pagado',\n    fallido: 'Fallido'\n  })[status] || status;\n  const openDetailModal = order => {\n    setSelectedOrder(order);\n    setStatusUpdate({\n      orderStatus: order.orderStatus,\n      paymentStatus: order.paymentStatus\n    });\n    setShowDetailModal(true);\n  };\n  const closeDetailModal = () => {\n    setShowDetailModal(false);\n    setSelectedOrder(null);\n  };\n\n  // ‚úÖ MEJORADO: Actualizar y refrescar selectedOrder\n  const updateOrderStatus = async () => {\n    try {\n      const token = sessionStorage.getItem('token');\n      await axios.put(`${API_URL}/orders/${selectedOrder._id}/status`, statusUpdate, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      toast.success('‚úÖ Estado actualizado y notificaci√≥n enviada al cliente');\n\n      // Recargar la lista\n      await loadOrders(false);\n\n      // Actualizar selectedOrder con la nueva data\n      const response = await axios.get(`${API_URL}/orders`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const updatedOrder = response.data.find(o => o._id === selectedOrder._id);\n      if (updatedOrder) {\n        setSelectedOrder(updatedOrder);\n      }\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      toast.error(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'Error al actualizar');\n    }\n  };\n  const forceGenerateLabel = async orderId => {\n    try {\n      const token = sessionStorage.getItem('token');\n      const loadingToast = toast.loading('Generando etiqueta...');\n      await axios.post(`${API_URL}/tracking/create`, {\n        orderId\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      toast.update(loadingToast, {\n        render: '‚úÖ Etiqueta generada',\n        type: 'success',\n        isLoading: false,\n        autoClose: 2000\n      });\n      loadOrders(false);\n    } catch (err) {\n      toast.error('Error al generar etiqueta');\n    }\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"admin-orders\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner-large\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 88\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Cargando pedidos...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 125\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 53\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 198,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"admin-orders\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Error\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 84\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 98\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        onClick: () => loadOrders(true),\n        children: \"\\uD83D\\uDD04 Reintentar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 112\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 51\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"admin-orders\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Gesti\\xF3n de Pedidos \", refreshing && /*#__PURE__*/_jsxDEV(\"small\", {\n          style: {\n            fontSize: '12px',\n            marginLeft: '10px'\n          },\n          children: \"\\uD83D\\uDD04 Actualizando...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 47\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"orders-stats\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-item\",\n          children: [\"Total: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: orders.length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 46\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-item\",\n          children: [\"Pendientes: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: orders.filter(o => o.orderStatus === 'pendiente').length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 51\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-item\",\n          children: [\"Con etiqueta: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: orders.filter(o => {\n              var _o$tracking;\n              return (_o$tracking = o.tracking) === null || _o$tracking === void 0 ? void 0 : _o$tracking.trackingNumber;\n            }).length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 53\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-secondary\",\n        onClick: () => loadOrders(true),\n        children: \"\\uD83D\\uDD04 Actualizar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"table-responsive\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"admin-table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"ID Pedido\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Cliente\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Total\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Estado Pago\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Estado Pedido\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Etiqueta\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Acciones\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: orders.map(order => {\n            var _order$user2, _order$tracking3;\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: order.orderStatus === 'pendiente' ? 'row-urgent' : '',\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: [\"#\", order._id.slice(-8)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 229,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"customer-cell\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: ((_order$user2 = order.user) === null || _order$user2 === void 0 ? void 0 : _order$user2.name) || 'Usuario'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 232,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                    children: [/*#__PURE__*/_jsxDEV(FaPhone, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 233,\n                      columnNumber: 28\n                    }, this), \" \", order.phone || 'S/T']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 233,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 231,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: formatPrice(order.totalAmount)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `badge ${getStatusBadge(order.paymentStatus)}`,\n                  children: getStatusLabel(order.paymentStatus)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `badge ${getStatusBadge(order.orderStatus)}`,\n                  children: getStatusLabel(order.orderStatus)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 238,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: (_order$tracking3 = order.tracking) !== null && _order$tracking3 !== void 0 && _order$tracking3.trackingNumber ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    gap: '5px'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-table btn-pdf\",\n                    onClick: () => downloadLabel(order),\n                    title: \"Descargar etiqueta PDF\",\n                    children: [/*#__PURE__*/_jsxDEV(FaDownload, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 243,\n                      columnNumber: 25\n                    }, this), \" Descargar\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 242,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-table btn-view\",\n                    onClick: () => viewLabel(order),\n                    title: \"Ver etiqueta\",\n                    style: {\n                      background: '#3498db'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(FaEye, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 246,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 245,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn-table\",\n                  style: {\n                    fontSize: '0.75rem',\n                    background: '#f39c12',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '4px',\n                    padding: '4px 8px',\n                    cursor: 'pointer'\n                  },\n                  onClick: () => forceGenerateLabel(order._id),\n                  children: \"\\uD83D\\uDCC4 Generar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"action-buttons\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn-icon btn-view\",\n                    onClick: () => openDetailModal(order),\n                    title: \"Ver detalles\",\n                    children: /*#__PURE__*/_jsxDEV(FaEye, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 262,\n                      columnNumber: 23\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 261,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 260,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 17\n              }, this)]\n            }, order._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 15\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }, this), showDetailModal && selectedOrder && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onClick: closeDetailModal,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content large\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"Gesti\\xF3n de Pedido #\", selectedOrder._id.slice(-8).toUpperCase()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"modal-close\",\n            onClick: closeDetailModal,\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"order-detail-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-grid-top\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"detail-card\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"\\uD83D\\uDCCD Direcci\\xF3n de Env\\xEDo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"address-box\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: ((_selectedOrder$user = selectedOrder.user) === null || _selectedOrder$user === void 0 ? void 0 : _selectedOrder$user.name) || 'Cliente'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 285,\n                    columnNumber: 24\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 285,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: (_selectedOrder$shippi = selectedOrder.shippingAddress) === null || _selectedOrder$shippi === void 0 ? void 0 : _selectedOrder$shippi.street\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [(_selectedOrder$shippi2 = selectedOrder.shippingAddress) === null || _selectedOrder$shippi2 === void 0 ? void 0 : _selectedOrder$shippi2.city, \", \", (_selectedOrder$shippi3 = selectedOrder.shippingAddress) === null || _selectedOrder$shippi3 === void 0 ? void 0 : _selectedOrder$shippi3.postalCode]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: (_selectedOrder$shippi4 = selectedOrder.shippingAddress) === null || _selectedOrder$shippi4 === void 0 ? void 0 : _selectedOrder$shippi4.country\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    marginTop: '10px',\n                    fontSize: '0.85rem',\n                    color: '#666'\n                  },\n                  children: [\"\\uD83D\\uDCDE \", selectedOrder.phone || 'Sin tel√©fono']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"detail-card\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"\\u2699\\uFE0F Estado del Pedido\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"status-update-form\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    style: {\n                      fontSize: '0.8rem',\n                      color: '#7f8c8d',\n                      display: 'block',\n                      marginBottom: '5px'\n                    },\n                    children: \"Cambiar Estado (se enviar\\xE1 email al cliente)\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 299,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    name: \"orderStatus\",\n                    value: statusUpdate.orderStatus,\n                    onChange: e => setStatusUpdate({\n                      ...statusUpdate,\n                      [e.target.name]: e.target.value\n                    }),\n                    className: \"form-select\",\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"pendiente\",\n                      children: \"Pendiente\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 305,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"procesando\",\n                      children: \"Procesando\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 306,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"enviado\",\n                      children: \"Enviado\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 307,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"entregado\",\n                      children: \"Entregado\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 308,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"cancelado\",\n                      children: \"Cancelado\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 309,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 302,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn-update-status\",\n                  onClick: updateOrderStatus,\n                  children: [/*#__PURE__*/_jsxDEV(FaEdit, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 313,\n                    columnNumber: 23\n                  }, this), \" Guardar y Notificar\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 312,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this), ((_selectedOrder$tracki = selectedOrder.tracking) === null || _selectedOrder$tracki === void 0 ? void 0 : _selectedOrder$tracki.trackingNumber) && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"\\uD83D\\uDE9A Informaci\\xF3n de Env\\xEDo\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: '15px',\n                background: '#f8f9fa',\n                borderRadius: '8px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Tracking:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 323,\n                  columnNumber: 24\n                }, this), \" \", selectedOrder.tracking.trackingNumber]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 323,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Transportista:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 24\n                }, this), \" \", selectedOrder.tracking.carrier || 'Correos Express']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Estado:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 24\n                }, this), \" \", selectedOrder.tracking.currentStatus || 'en_preparacion']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginTop: '15px',\n                  display: 'flex',\n                  gap: '10px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn-update-status\",\n                  onClick: () => downloadLabel(selectedOrder),\n                  style: {\n                    flex: 1\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(FaDownload, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 328,\n                    columnNumber: 25\n                  }, this), \" Descargar Etiqueta\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 327,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn-update-status\",\n                  onClick: () => viewLabel(selectedOrder),\n                  style: {\n                    flex: 1,\n                    background: '#3498db'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(FaEye, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 331,\n                    columnNumber: 25\n                  }, this), \" Ver Etiqueta\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 326,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail-card full-width\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: [\"\\uD83D\\uDCE6 Productos (\", ((_selectedOrder$items = selectedOrder.items) === null || _selectedOrder$items === void 0 ? void 0 : _selectedOrder$items.length) || 0, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"order-items-list\",\n              children: (_selectedOrder$items2 = selectedOrder.items) === null || _selectedOrder$items2 === void 0 ? void 0 : _selectedOrder$items2.map((item, index) => {\n                var _item$product;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"item-row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"item-main\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"item-qty\",\n                      children: [item.quantity, \"x\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 344,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"item-name\",\n                      children: ((_item$product = item.product) === null || _item$product === void 0 ? void 0 : _item$product.name) || 'Producto'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 345,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 343,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"item-subtotal\",\n                    children: formatPrice(item.price * item.quantity)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 347,\n                    columnNumber: 23\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 21\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"order-total-display\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Total Pedido:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: formatPrice(selectedOrder.totalAmount)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 202,\n    columnNumber: 5\n  }, this);\n};\n_s(AdminOrders, \"ulfUA7gdDgL1V8AFmpcPo7mdDFs=\");\n_c = AdminOrders;\nexport default AdminOrders;\nvar _c;\n$RefreshReg$(_c, \"AdminOrders\");","map":{"version":3,"names":["React","useState","useEffect","useRef","FaEye","FaEdit","FaPhone","FaDownload","axios","toast","jsxDEV","_jsxDEV","AdminOrders","_s","_selectedOrder$user","_selectedOrder$shippi","_selectedOrder$shippi2","_selectedOrder$shippi3","_selectedOrder$shippi4","_selectedOrder$tracki","_selectedOrder$items","_selectedOrder$items2","orders","setOrders","loading","setLoading","refreshing","setRefreshing","selectedOrder","setSelectedOrder","showDetailModal","setShowDetailModal","statusUpdate","setStatusUpdate","orderStatus","paymentStatus","error","setError","notifiedOrders","Set","isFirstLoad","API_URL","process","env","REACT_APP_API_URL","loadOrders","Notification","permission","requestPermission","interval","setInterval","clearInterval","newOrders","filter","o","current","has","_id","length","forEach","add","handleNewOrderNotification","audio","Audio","play","catch","order","_order$user","success","slice","toUpperCase","user","name","formatPrice","totalAmount","position","autoClose","navigator","vibrate","body","icon","initial","token","sessionStorage","getItem","response","get","headers","Authorization","ordersData","Array","isArray","data","_error$response","_error$response$data","message","downloadLabel","_order$tracking","trackingNumber","tracking","loadingToast","method","url","responseType","update","render","type","isLoading","blob","Blob","window","URL","createObjectURL","link","document","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","err","_err$response","_err$response2","msg","status","viewLabel","_order$tracking2","open","price","Intl","NumberFormat","style","currency","format","getStatusBadge","pendiente","procesando","enviado","entregado","cancelado","pagado","fallido","getStatusLabel","openDetailModal","closeDetailModal","updateOrderStatus","put","updatedOrder","find","_error$response2","_error$response2$data","forceGenerateLabel","orderId","post","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","fontSize","marginLeft","_o$tracking","map","_order$user2","_order$tracking3","phone","display","gap","title","background","color","border","borderRadius","padding","cursor","e","stopPropagation","shippingAddress","street","city","postalCode","country","marginTop","marginBottom","value","onChange","target","carrier","currentStatus","flex","items","item","index","_item$product","quantity","product","_c","$RefreshReg$"],"sources":["C:/Users/ashu_/Documents/ecommerce-sim/frontend/src/pages/admin/AdminOrders.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { FaEye, FaEdit, FaPhone, FaDownload } from 'react-icons/fa';\r\nimport axios from 'axios';\r\nimport '../../styles/AdminOrders.css';\r\nimport { toast } from 'react-toastify';\r\n\r\nconst AdminOrders = () => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [selectedOrder, setSelectedOrder] = useState(null);\r\n  const [showDetailModal, setShowDetailModal] = useState(false);\r\n  const [statusUpdate, setStatusUpdate] = useState({ orderStatus: '', paymentStatus: '' });\r\n  const [error, setError] = useState(null);\r\n\r\n  const notifiedOrders = useRef(new Set());\r\n  const isFirstLoad = useRef(true);\r\n  const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\n  useEffect(() => {\r\n    loadOrders(true);\r\n    if (Notification.permission === 'default') Notification.requestPermission();\r\n    const interval = setInterval(() => loadOrders(false), 10000); // ‚úÖ 10s en vez de 30s\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const newOrders = orders.filter(\r\n      o => !notifiedOrders.current.has(o._id) && o.orderStatus === 'pendiente'\r\n    );\r\n    if (newOrders.length > 0 && !isFirstLoad.current) {\r\n      newOrders.forEach(o => notifiedOrders.current.add(o._id));\r\n      handleNewOrderNotification(newOrders);\r\n    }\r\n  }, [orders]);\r\n\r\n  // ‚úÖ NUEVO: Actualizar statusUpdate cuando selectedOrder cambie\r\n  useEffect(() => {\r\n    if (selectedOrder) {\r\n      setStatusUpdate({\r\n        orderStatus: selectedOrder.orderStatus,\r\n        paymentStatus: selectedOrder.paymentStatus\r\n      });\r\n    }\r\n  }, [selectedOrder]);\r\n\r\n  const handleNewOrderNotification = (newOrders) => {\r\n    const audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3');\r\n    audio.play().catch(() => {});\r\n    newOrders.forEach(order => {\r\n      toast.success(\r\n        `üîî ¬°NUEVO PEDIDO! #${order._id.slice(-6).toUpperCase()}\\nCliente: ${order.user?.name || 'Desconocido'}\\nTotal: ${formatPrice(order.totalAmount)}`,\r\n        { position: 'top-right', autoClose: 8000 }\r\n      );\r\n    });\r\n    if (navigator.vibrate) navigator.vibrate([200, 100, 200]);\r\n    if (Notification.permission === 'granted') {\r\n      new Notification('üõí Nuevo pedido recibido', { body: `${newOrders.length} pedido(s) nuevo(s)`, icon: '/logo192.png' });\r\n    }\r\n  };\r\n\r\n  const loadOrders = async (initial = false) => {\r\n    try {\r\n      if (initial) setLoading(true);\r\n      setRefreshing(true);\r\n      setError(null);\r\n      const token = sessionStorage.getItem('token');\r\n      if (!token) { setError('No est√°s autenticado.'); setLoading(false); return; }\r\n\r\n      const response = await axios.get(`${API_URL}/orders`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n\r\n      const ordersData = Array.isArray(response.data) ? response.data : [];\r\n      setOrders(ordersData);\r\n\r\n      if (initial) {\r\n        ordersData.forEach(o => notifiedOrders.current.add(o._id));\r\n        isFirstLoad.current = false;\r\n      }\r\n    } catch (error) {\r\n      if (initial) setError(error.response?.data?.message || 'Error al cargar los pedidos');\r\n    } finally {\r\n      setLoading(false);\r\n      setRefreshing(false);\r\n    }\r\n  };\r\n\r\n  const downloadLabel = async (order) => {\r\n    try {\r\n      const trackingNumber = order.tracking?.trackingNumber;\r\n      if (!trackingNumber) {\r\n        toast.error('Etiqueta a√∫n no disponible, pulsa Actualizar en unos segundos');\r\n        return;\r\n      }\r\n\r\n      const token = sessionStorage.getItem('token');\r\n      if (!token) { toast.error('Sesi√≥n expirada'); return; }\r\n\r\n      const loadingToast = toast.loading('Descargando etiqueta...');\r\n\r\n      const response = await axios({\r\n        method: 'GET',\r\n        url: `${API_URL}/tracking/${trackingNumber}/label`,\r\n        headers: { Authorization: `Bearer ${token}` },\r\n        responseType: 'blob'\r\n      });\r\n\r\n      toast.update(loadingToast, { render: '‚úÖ Descargando...', type: 'success', isLoading: false, autoClose: 1000 });\r\n\r\n      const blob = new Blob([response.data], { type: 'application/pdf' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = `etiqueta-${trackingNumber}.pdf`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (err) {\r\n      const msg = err.response?.status === 404 ? 'Etiqueta a√∫n no disponible'\r\n        : err.response?.status === 401 ? 'Sesi√≥n expirada'\r\n        : 'Error al descargar la etiqueta';\r\n      toast.error(msg);\r\n    }\r\n  };\r\n\r\n  const viewLabel = (order) => {\r\n    const trackingNumber = order.tracking?.trackingNumber;\r\n    if (!trackingNumber) { toast.error('Sin etiqueta disponible'); return; }\r\n    const token = sessionStorage.getItem('token');\r\n    window.open(`${API_URL}/tracking/${trackingNumber}/label/preview?token=${token}`, '_blank');\r\n  };\r\n\r\n  const formatPrice = (price) =>\r\n    new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR' }).format(price);\r\n\r\n  const getStatusBadge = (status) => ({\r\n    pendiente: 'badge-warning', procesando: 'badge-info', enviado: 'badge-primary',\r\n    entregado: 'badge-success', cancelado: 'badge-danger', pagado: 'badge-success', fallido: 'badge-danger'\r\n  }[status] || 'badge-secondary');\r\n\r\n  const getStatusLabel = (status) => ({\r\n    pendiente: 'Pendiente', procesando: 'Procesando', enviado: 'Enviado',\r\n    entregado: 'Entregado', cancelado: 'Cancelado', pagado: 'Pagado', fallido: 'Fallido'\r\n  }[status] || status);\r\n\r\n  const openDetailModal = (order) => {\r\n    setSelectedOrder(order);\r\n    setStatusUpdate({ orderStatus: order.orderStatus, paymentStatus: order.paymentStatus });\r\n    setShowDetailModal(true);\r\n  };\r\n\r\n  const closeDetailModal = () => { setShowDetailModal(false); setSelectedOrder(null); };\r\n\r\n  // ‚úÖ MEJORADO: Actualizar y refrescar selectedOrder\r\n  const updateOrderStatus = async () => {\r\n    try {\r\n      const token = sessionStorage.getItem('token');\r\n      await axios.put(\r\n        `${API_URL}/orders/${selectedOrder._id}/status`,\r\n        statusUpdate,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );\r\n      \r\n      toast.success('‚úÖ Estado actualizado y notificaci√≥n enviada al cliente');\r\n      \r\n      // Recargar la lista\r\n      await loadOrders(false);\r\n      \r\n      // Actualizar selectedOrder con la nueva data\r\n      const response = await axios.get(`${API_URL}/orders`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      const updatedOrder = response.data.find(o => o._id === selectedOrder._id);\r\n      if (updatedOrder) {\r\n        setSelectedOrder(updatedOrder);\r\n      }\r\n    } catch (error) {\r\n      toast.error(error.response?.data?.message || 'Error al actualizar');\r\n    }\r\n  };\r\n\r\n  const forceGenerateLabel = async (orderId) => {\r\n    try {\r\n      const token = sessionStorage.getItem('token');\r\n      const loadingToast = toast.loading('Generando etiqueta...');\r\n      await axios.post(`${API_URL}/tracking/create`, { orderId }, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      toast.update(loadingToast, { render: '‚úÖ Etiqueta generada', type: 'success', isLoading: false, autoClose: 2000 });\r\n      loadOrders(false);\r\n    } catch (err) {\r\n      toast.error('Error al generar etiqueta');\r\n    }\r\n  };\r\n\r\n  if (loading) return <div className=\"admin-orders\"><div className=\"loading-container\"><div className=\"spinner-large\"></div><p>Cargando pedidos...</p></div></div>;\r\n  if (error) return <div className=\"admin-orders\"><div className=\"error-container\"><h3>Error</h3><p>{error}</p><button className=\"btn btn-primary\" onClick={() => loadOrders(true)}>üîÑ Reintentar</button></div></div>;\r\n\r\n  return (\r\n    <div className=\"admin-orders\">\r\n      <div className=\"page-header\">\r\n        <h2>Gesti√≥n de Pedidos {refreshing && <small style={{ fontSize: '12px', marginLeft: '10px' }}>üîÑ Actualizando...</small>}</h2>\r\n        <div className=\"orders-stats\">\r\n          <span className=\"stat-item\">Total: <strong>{orders.length}</strong></span>\r\n          <span className=\"stat-item\">Pendientes: <strong>{orders.filter(o => o.orderStatus === 'pendiente').length}</strong></span>\r\n          <span className=\"stat-item\">Con etiqueta: <strong>{orders.filter(o => o.tracking?.trackingNumber).length}</strong></span>\r\n        </div>\r\n        <button className=\"btn btn-secondary\" onClick={() => loadOrders(true)}>üîÑ Actualizar</button>\r\n      </div>\r\n\r\n      <div className=\"table-responsive\">\r\n        <table className=\"admin-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>ID Pedido</th>\r\n              <th>Cliente</th>\r\n              <th>Total</th>\r\n              <th>Estado Pago</th>\r\n              <th>Estado Pedido</th>\r\n              <th>Etiqueta</th>\r\n              <th>Acciones</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {orders.map(order => (\r\n              <tr key={order._id} className={order.orderStatus === 'pendiente' ? 'row-urgent' : ''}>\r\n                <td><strong>#{order._id.slice(-8)}</strong></td>\r\n                <td>\r\n                  <div className=\"customer-cell\">\r\n                    <strong>{order.user?.name || 'Usuario'}</strong>\r\n                    <small><FaPhone /> {order.phone || 'S/T'}</small>\r\n                  </div>\r\n                </td>\r\n                <td><strong>{formatPrice(order.totalAmount)}</strong></td>\r\n                <td><span className={`badge ${getStatusBadge(order.paymentStatus)}`}>{getStatusLabel(order.paymentStatus)}</span></td>\r\n                <td><span className={`badge ${getStatusBadge(order.orderStatus)}`}>{getStatusLabel(order.orderStatus)}</span></td>\r\n                <td>\r\n                  {order.tracking?.trackingNumber ? (\r\n                    <div style={{ display: 'flex', gap: '5px' }}>\r\n                      <button className=\"btn-table btn-pdf\" onClick={() => downloadLabel(order)} title=\"Descargar etiqueta PDF\">\r\n                        <FaDownload /> Descargar\r\n                      </button>\r\n                      <button className=\"btn-table btn-view\" onClick={() => viewLabel(order)} title=\"Ver etiqueta\" style={{ background: '#3498db' }}>\r\n                        <FaEye />\r\n                      </button>\r\n                    </div>\r\n                  ) : (\r\n                    <button\r\n                      className=\"btn-table\"\r\n                      style={{ fontSize: '0.75rem', background: '#f39c12', color: 'white', border: 'none', borderRadius: '4px', padding: '4px 8px', cursor: 'pointer' }}\r\n                      onClick={() => forceGenerateLabel(order._id)}\r\n                    >\r\n                      üìÑ Generar\r\n                    </button>\r\n                  )}\r\n                </td>\r\n                <td>\r\n                  <div className=\"action-buttons\">\r\n                    <button className=\"btn-icon btn-view\" onClick={() => openDetailModal(order)} title=\"Ver detalles\">\r\n                      <FaEye />\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {showDetailModal && selectedOrder && (\r\n        <div className=\"modal-overlay\" onClick={closeDetailModal}>\r\n          <div className=\"modal-content large\" onClick={e => e.stopPropagation()}>\r\n            <div className=\"modal-header\">\r\n              <h3>Gesti√≥n de Pedido #{selectedOrder._id.slice(-8).toUpperCase()}</h3>\r\n              <button className=\"modal-close\" onClick={closeDetailModal}>&times;</button>\r\n            </div>\r\n\r\n            <div className=\"order-detail-container\">\r\n              <div className=\"detail-grid-top\">\r\n                <div className=\"detail-card\">\r\n                  <h4>üìç Direcci√≥n de Env√≠o</h4>\r\n                  <div className=\"address-box\">\r\n                    <p><strong>{selectedOrder.user?.name || 'Cliente'}</strong></p>\r\n                    <p>{selectedOrder.shippingAddress?.street}</p>\r\n                    <p>{selectedOrder.shippingAddress?.city}, {selectedOrder.shippingAddress?.postalCode}</p>\r\n                    <p>{selectedOrder.shippingAddress?.country}</p>\r\n                    <p style={{ marginTop: '10px', fontSize: '0.85rem', color: '#666' }}>\r\n                      üìû {selectedOrder.phone || 'Sin tel√©fono'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"detail-card\">\r\n                  <h4>‚öôÔ∏è Estado del Pedido</h4>\r\n                  <div className=\"status-update-form\">\r\n                    <div className=\"form-group\">\r\n                      <label style={{ fontSize: '0.8rem', color: '#7f8c8d', display: 'block', marginBottom: '5px' }}>\r\n                        Cambiar Estado (se enviar√° email al cliente)\r\n                      </label>\r\n                      <select name=\"orderStatus\" value={statusUpdate.orderStatus}\r\n                        onChange={e => setStatusUpdate({ ...statusUpdate, [e.target.name]: e.target.value })}\r\n                        className=\"form-select\">\r\n                        <option value=\"pendiente\">Pendiente</option>\r\n                        <option value=\"procesando\">Procesando</option>\r\n                        <option value=\"enviado\">Enviado</option>\r\n                        <option value=\"entregado\">Entregado</option>\r\n                        <option value=\"cancelado\">Cancelado</option>\r\n                      </select>\r\n                    </div>\r\n                    <button className=\"btn-update-status\" onClick={updateOrderStatus}>\r\n                      <FaEdit /> Guardar y Notificar\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {selectedOrder.tracking?.trackingNumber && (\r\n                <div className=\"detail-card\">\r\n                  <h4>üöö Informaci√≥n de Env√≠o</h4>\r\n                  <div style={{ padding: '15px', background: '#f8f9fa', borderRadius: '8px' }}>\r\n                    <p><strong>Tracking:</strong> {selectedOrder.tracking.trackingNumber}</p>\r\n                    <p><strong>Transportista:</strong> {selectedOrder.tracking.carrier || 'Correos Express'}</p>\r\n                    <p><strong>Estado:</strong> {selectedOrder.tracking.currentStatus || 'en_preparacion'}</p>\r\n                    <div style={{ marginTop: '15px', display: 'flex', gap: '10px' }}>\r\n                      <button className=\"btn-update-status\" onClick={() => downloadLabel(selectedOrder)} style={{ flex: 1 }}>\r\n                        <FaDownload /> Descargar Etiqueta\r\n                      </button>\r\n                      <button className=\"btn-update-status\" onClick={() => viewLabel(selectedOrder)} style={{ flex: 1, background: '#3498db' }}>\r\n                        <FaEye /> Ver Etiqueta\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"detail-card full-width\">\r\n                <h4>üì¶ Productos ({selectedOrder.items?.length || 0})</h4>\r\n                <div className=\"order-items-list\">\r\n                  {selectedOrder.items?.map((item, index) => (\r\n                    <div key={index} className=\"item-row\">\r\n                      <div className=\"item-main\">\r\n                        <span className=\"item-qty\">{item.quantity}x</span>\r\n                        <span className=\"item-name\">{item.product?.name || 'Producto'}</span>\r\n                      </div>\r\n                      <span className=\"item-subtotal\">{formatPrice(item.price * item.quantity)}</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n                <div className=\"order-total-display\">\r\n                  <span>Total Pedido:</span>\r\n                  <strong>{formatPrice(selectedOrder.totalAmount)}</strong>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminOrders;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}