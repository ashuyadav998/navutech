{"ast":null,"code":"import _objectSpread from\"C:/Users/ashu_/Documents/ecommerce-sim/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Link,useNavigate,useLocation}from'react-router-dom';import{useAuth}from'../context/AuthContext';import'../styles/Auth.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const navigate=useNavigate();const location=useLocation();const{login,isAuthenticated,user}=useAuth();// ‚úÖ A√±adir user\nconst[formData,setFormData]=useState({email:'',password:''});const[error,setError]=useState('');const[loading,setLoading]=useState(false);// Si ya est√° autenticado, redirigir\nuseEffect(()=>{if(isAuthenticated()){var _location$state,_location$state$from;console.log('‚úÖ Ya autenticado, redirigiendo...');// ‚úÖ DEBUG\nconst from=((_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||'/';navigate(from,{replace:true});}},[isAuthenticated,navigate,location]);const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();setError('');setLoading(true);console.log('üîµ [LOGIN COMPONENT] Iniciando login...');// ‚úÖ DEBUG\ntry{// ‚úÖ USAR LA FUNCI√ìN LOGIN DEL AUTHCONTEXT\nconst result=await login(formData.email,formData.password);console.log('üîµ [LOGIN COMPONENT] Resultado:',result);// ‚úÖ DEBUG\nif(result.success){console.log('‚úÖ [LOGIN COMPONENT] Login exitoso');// ‚úÖ DEBUG\n// Esperar un momento para que el estado se actualice\nsetTimeout(()=>{var _result$user;// Redirigir seg√∫n el rol\nif(((_result$user=result.user)===null||_result$user===void 0?void 0:_result$user.role)==='admin'){console.log('üîµ [LOGIN COMPONENT] Redirigiendo a /admin');// ‚úÖ DEBUG\nnavigate('/admin',{replace:true});}else{var _location$state2,_location$state2$from;const from=((_location$state2=location.state)===null||_location$state2===void 0?void 0:(_location$state2$from=_location$state2.from)===null||_location$state2$from===void 0?void 0:_location$state2$from.pathname)||'/';console.log('üîµ [LOGIN COMPONENT] Redirigiendo a:',from);// ‚úÖ DEBUG\nnavigate(from,{replace:true});}},100);}else{setError(result.message||'Error al iniciar sesi√≥n');}}catch(err){console.error('‚ùå [LOGIN COMPONENT] Error:',err);// ‚úÖ DEBUG\nsetError('Error inesperado al iniciar sesi√≥n');}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-card\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Iniciar Sesi\\xF3n\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",name:\"email\",value:formData.email,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",value:formData.password,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",disabled:loading,children:loading?'Iniciando sesi√≥n...':'Iniciar Sesi√≥n'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"auth-link\",children:[\"\\xBFNo tienes cuenta? \",/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"Reg\\xEDstrate aqu\\xED\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"forgot-password-link\",children:/*#__PURE__*/_jsx(Link,{to:\"/forgot-password\",children:\"\\xBFOlvidaste tu contrase\\xF1a?\"})})]})})});};export default Login;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","useLocation","useAuth","jsx","_jsx","jsxs","_jsxs","Login","navigate","location","login","isAuthenticated","user","formData","setFormData","email","password","error","setError","loading","setLoading","_location$state","_location$state$from","console","log","from","state","pathname","replace","handleChange","e","_objectSpread","target","name","value","handleSubmit","preventDefault","result","success","setTimeout","_result$user","role","_location$state2","_location$state2$from","message","err","className","children","onSubmit","htmlFor","type","id","onChange","required","disabled","to"],"sources":["C:/Users/ashu_/Documents/ecommerce-sim/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport '../styles/Auth.css';\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { login, isAuthenticated, user } = useAuth(); // ‚úÖ A√±adir user\n  \n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  });\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  // Si ya est√° autenticado, redirigir\n  useEffect(() => {\n    if (isAuthenticated()) {\n      console.log('‚úÖ Ya autenticado, redirigiendo...'); // ‚úÖ DEBUG\n      const from = location.state?.from?.pathname || '/';\n      navigate(from, { replace: true });\n    }\n  }, [isAuthenticated, navigate, location]);\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    console.log('üîµ [LOGIN COMPONENT] Iniciando login...'); // ‚úÖ DEBUG\n\n    try {\n      // ‚úÖ USAR LA FUNCI√ìN LOGIN DEL AUTHCONTEXT\n      const result = await login(formData.email, formData.password);\n      \n      console.log('üîµ [LOGIN COMPONENT] Resultado:', result); // ‚úÖ DEBUG\n\n      if (result.success) {\n        console.log('‚úÖ [LOGIN COMPONENT] Login exitoso'); // ‚úÖ DEBUG\n        \n        // Esperar un momento para que el estado se actualice\n        setTimeout(() => {\n          // Redirigir seg√∫n el rol\n          if (result.user?.role === 'admin') {\n            console.log('üîµ [LOGIN COMPONENT] Redirigiendo a /admin'); // ‚úÖ DEBUG\n            navigate('/admin', { replace: true });\n          } else {\n            const from = location.state?.from?.pathname || '/';\n            console.log('üîµ [LOGIN COMPONENT] Redirigiendo a:', from); // ‚úÖ DEBUG\n            navigate(from, { replace: true });\n          }\n        }, 100);\n      } else {\n        setError(result.message || 'Error al iniciar sesi√≥n');\n      }\n    } catch (err) {\n      console.error('‚ùå [LOGIN COMPONENT] Error:', err); // ‚úÖ DEBUG\n      setError('Error inesperado al iniciar sesi√≥n');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"auth-page\">\n      <div className=\"container\">\n        <div className=\"auth-card\">\n          <h1>Iniciar Sesi√≥n</h1>\n\n          {error && <div className=\"error-message\">{error}</div>}\n\n          <form onSubmit={handleSubmit}>\n            <div className=\"form-group\">\n              <label htmlFor=\"email\">Email</label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"password\">Contrase√±a</label>\n              <input\n                type=\"password\"\n                id=\"password\"\n                name=\"password\"\n                value={formData.password}\n                onChange={handleChange}\n                required\n              />\n            </div>\n\n            <button type=\"submit\" className=\"submit-btn\" disabled={loading}>\n              {loading ? 'Iniciando sesi√≥n...' : 'Iniciar Sesi√≥n'}\n            </button>\n          </form>\n\n          <p className=\"auth-link\">\n            ¬øNo tienes cuenta? <Link to=\"/register\">Reg√≠strate aqu√≠</Link>\n          </p>\n          <div className=\"forgot-password-link\">\n       <Link to=\"/forgot-password\">¬øOlvidaste tu contrase√±a?</Link>\n  </div>\n          \n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}