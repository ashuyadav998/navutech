{"ast":null,"code":"// frontend/src/services/socketService.js\nimport{io}from'socket.io-client';const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';const SOCKET_URL=API_URL.replace('/api','');class SocketService{constructor(){this.socket=null;this.isInitialized=false;this.eventListeners=new Map();}initialize(){if(this.isInitialized&&this.socket){console.log('‚ö†Ô∏è Socket ya inicializado');return this.socket;}console.log('üîå Inicializando socket service...');this.socket=io(SOCKET_URL,{transports:['websocket','polling'],reconnection:true,reconnectionAttempts:10,reconnectionDelay:1000,autoConnect:true});this.socket.on('connect',()=>{console.log('‚úÖ Socket conectado:',this.socket.id);});this.socket.on('disconnect',reason=>{console.log('‚ùå Socket desconectado:',reason);});this.isInitialized=true;return this.socket;}authenticate(token){if(!this.socket){console.error('‚ùå Socket no inicializado');return;}console.log('üîë Autenticando socket...');this.socket.emit('authenticate',token);}on(event,callback){if(!this.socket){console.error('‚ùå Socket no inicializado');return;}// Remover listener anterior si existe\nif(this.eventListeners.has(event)){this.socket.off(event,this.eventListeners.get(event));}this.socket.on(event,callback);this.eventListeners.set(event,callback);}emit(event,data){if(!this.socket){console.error('‚ùå Socket no inicializado');return;}this.socket.emit(event,data);}removeListener(event){if(!this.socket)return;const callback=this.eventListeners.get(event);if(callback){this.socket.off(event,callback);this.eventListeners.delete(event);}}disconnect(){if(this.socket){console.log('üîå Desconectando socket...');this.socket.disconnect();this.socket=null;this.isInitialized=false;this.eventListeners.clear();}}getSocket(){return this.socket;}isConnected(){return this.socket&&this.socket.connected;}}// Exportar una √∫nica instancia\nconst socketService=new SocketService();export default socketService;","map":{"version":3,"names":["io","API_URL","process","env","REACT_APP_API_URL","SOCKET_URL","replace","SocketService","constructor","socket","isInitialized","eventListeners","Map","initialize","console","log","transports","reconnection","reconnectionAttempts","reconnectionDelay","autoConnect","on","id","reason","authenticate","token","error","emit","event","callback","has","off","get","set","data","removeListener","delete","disconnect","clear","getSocket","isConnected","connected","socketService"],"sources":["C:/Users/ashu_/Documents/ecommerce-sim/frontend/src/services/socketService.js"],"sourcesContent":["// frontend/src/services/socketService.js\r\nimport { io } from 'socket.io-client';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\nconst SOCKET_URL = API_URL.replace('/api', '');\r\n\r\nclass SocketService {\r\n  constructor() {\r\n    this.socket = null;\r\n    this.isInitialized = false;\r\n    this.eventListeners = new Map();\r\n  }\r\n\r\n  initialize() {\r\n    if (this.isInitialized && this.socket) {\r\n      console.log('‚ö†Ô∏è Socket ya inicializado');\r\n      return this.socket;\r\n    }\r\n\r\n    console.log('üîå Inicializando socket service...');\r\n\r\n    this.socket = io(SOCKET_URL, {\r\n      transports: ['websocket', 'polling'],\r\n      reconnection: true,\r\n      reconnectionAttempts: 10,\r\n      reconnectionDelay: 1000,\r\n      autoConnect: true\r\n    });\r\n\r\n    this.socket.on('connect', () => {\r\n      console.log('‚úÖ Socket conectado:', this.socket.id);\r\n    });\r\n\r\n    this.socket.on('disconnect', (reason) => {\r\n      console.log('‚ùå Socket desconectado:', reason);\r\n    });\r\n\r\n    this.isInitialized = true;\r\n    return this.socket;\r\n  }\r\n\r\n  authenticate(token) {\r\n    if (!this.socket) {\r\n      console.error('‚ùå Socket no inicializado');\r\n      return;\r\n    }\r\n\r\n    console.log('üîë Autenticando socket...');\r\n    this.socket.emit('authenticate', token);\r\n  }\r\n\r\n  on(event, callback) {\r\n    if (!this.socket) {\r\n      console.error('‚ùå Socket no inicializado');\r\n      return;\r\n    }\r\n\r\n    // Remover listener anterior si existe\r\n    if (this.eventListeners.has(event)) {\r\n      this.socket.off(event, this.eventListeners.get(event));\r\n    }\r\n\r\n    this.socket.on(event, callback);\r\n    this.eventListeners.set(event, callback);\r\n  }\r\n\r\n  emit(event, data) {\r\n    if (!this.socket) {\r\n      console.error('‚ùå Socket no inicializado');\r\n      return;\r\n    }\r\n\r\n    this.socket.emit(event, data);\r\n  }\r\n\r\n  removeListener(event) {\r\n    if (!this.socket) return;\r\n\r\n    const callback = this.eventListeners.get(event);\r\n    if (callback) {\r\n      this.socket.off(event, callback);\r\n      this.eventListeners.delete(event);\r\n    }\r\n  }\r\n\r\n  disconnect() {\r\n    if (this.socket) {\r\n      console.log('üîå Desconectando socket...');\r\n      this.socket.disconnect();\r\n      this.socket = null;\r\n      this.isInitialized = false;\r\n      this.eventListeners.clear();\r\n    }\r\n  }\r\n\r\n  getSocket() {\r\n    return this.socket;\r\n  }\r\n\r\n  isConnected() {\r\n    return this.socket && this.socket.connected;\r\n  }\r\n}\r\n\r\n// Exportar una √∫nica instancia\r\nconst socketService = new SocketService();\r\nexport default socketService;"],"mappings":"AAAA;AACA,OAASA,EAAE,KAAQ,kBAAkB,CAErC,KAAM,CAAAC,OAAO,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,2BAA2B,CAC5E,KAAM,CAAAC,UAAU,CAAGJ,OAAO,CAACK,OAAO,CAAC,MAAM,CAAE,EAAE,CAAC,CAE9C,KAAM,CAAAC,aAAc,CAClBC,WAAWA,CAAA,CAAG,CACZ,IAAI,CAACC,MAAM,CAAG,IAAI,CAClB,IAAI,CAACC,aAAa,CAAG,KAAK,CAC1B,IAAI,CAACC,cAAc,CAAG,GAAI,CAAAC,GAAG,CAAC,CAAC,CACjC,CAEAC,UAAUA,CAAA,CAAG,CACX,GAAI,IAAI,CAACH,aAAa,EAAI,IAAI,CAACD,MAAM,CAAE,CACrCK,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CACxC,MAAO,KAAI,CAACN,MAAM,CACpB,CAEAK,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC,CAEjD,IAAI,CAACN,MAAM,CAAGT,EAAE,CAACK,UAAU,CAAE,CAC3BW,UAAU,CAAE,CAAC,WAAW,CAAE,SAAS,CAAC,CACpCC,YAAY,CAAE,IAAI,CAClBC,oBAAoB,CAAE,EAAE,CACxBC,iBAAiB,CAAE,IAAI,CACvBC,WAAW,CAAE,IACf,CAAC,CAAC,CAEF,IAAI,CAACX,MAAM,CAACY,EAAE,CAAC,SAAS,CAAE,IAAM,CAC9BP,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAE,IAAI,CAACN,MAAM,CAACa,EAAE,CAAC,CACpD,CAAC,CAAC,CAEF,IAAI,CAACb,MAAM,CAACY,EAAE,CAAC,YAAY,CAAGE,MAAM,EAAK,CACvCT,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEQ,MAAM,CAAC,CAC/C,CAAC,CAAC,CAEF,IAAI,CAACb,aAAa,CAAG,IAAI,CACzB,MAAO,KAAI,CAACD,MAAM,CACpB,CAEAe,YAAYA,CAACC,KAAK,CAAE,CAClB,GAAI,CAAC,IAAI,CAAChB,MAAM,CAAE,CAChBK,OAAO,CAACY,KAAK,CAAC,0BAA0B,CAAC,CACzC,OACF,CAEAZ,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CACxC,IAAI,CAACN,MAAM,CAACkB,IAAI,CAAC,cAAc,CAAEF,KAAK,CAAC,CACzC,CAEAJ,EAAEA,CAACO,KAAK,CAAEC,QAAQ,CAAE,CAClB,GAAI,CAAC,IAAI,CAACpB,MAAM,CAAE,CAChBK,OAAO,CAACY,KAAK,CAAC,0BAA0B,CAAC,CACzC,OACF,CAEA;AACA,GAAI,IAAI,CAACf,cAAc,CAACmB,GAAG,CAACF,KAAK,CAAC,CAAE,CAClC,IAAI,CAACnB,MAAM,CAACsB,GAAG,CAACH,KAAK,CAAE,IAAI,CAACjB,cAAc,CAACqB,GAAG,CAACJ,KAAK,CAAC,CAAC,CACxD,CAEA,IAAI,CAACnB,MAAM,CAACY,EAAE,CAACO,KAAK,CAAEC,QAAQ,CAAC,CAC/B,IAAI,CAAClB,cAAc,CAACsB,GAAG,CAACL,KAAK,CAAEC,QAAQ,CAAC,CAC1C,CAEAF,IAAIA,CAACC,KAAK,CAAEM,IAAI,CAAE,CAChB,GAAI,CAAC,IAAI,CAACzB,MAAM,CAAE,CAChBK,OAAO,CAACY,KAAK,CAAC,0BAA0B,CAAC,CACzC,OACF,CAEA,IAAI,CAACjB,MAAM,CAACkB,IAAI,CAACC,KAAK,CAAEM,IAAI,CAAC,CAC/B,CAEAC,cAAcA,CAACP,KAAK,CAAE,CACpB,GAAI,CAAC,IAAI,CAACnB,MAAM,CAAE,OAElB,KAAM,CAAAoB,QAAQ,CAAG,IAAI,CAAClB,cAAc,CAACqB,GAAG,CAACJ,KAAK,CAAC,CAC/C,GAAIC,QAAQ,CAAE,CACZ,IAAI,CAACpB,MAAM,CAACsB,GAAG,CAACH,KAAK,CAAEC,QAAQ,CAAC,CAChC,IAAI,CAAClB,cAAc,CAACyB,MAAM,CAACR,KAAK,CAAC,CACnC,CACF,CAEAS,UAAUA,CAAA,CAAG,CACX,GAAI,IAAI,CAAC5B,MAAM,CAAE,CACfK,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC,CACzC,IAAI,CAACN,MAAM,CAAC4B,UAAU,CAAC,CAAC,CACxB,IAAI,CAAC5B,MAAM,CAAG,IAAI,CAClB,IAAI,CAACC,aAAa,CAAG,KAAK,CAC1B,IAAI,CAACC,cAAc,CAAC2B,KAAK,CAAC,CAAC,CAC7B,CACF,CAEAC,SAASA,CAAA,CAAG,CACV,MAAO,KAAI,CAAC9B,MAAM,CACpB,CAEA+B,WAAWA,CAAA,CAAG,CACZ,MAAO,KAAI,CAAC/B,MAAM,EAAI,IAAI,CAACA,MAAM,CAACgC,SAAS,CAC7C,CACF,CAEA;AACA,KAAM,CAAAC,aAAa,CAAG,GAAI,CAAAnC,aAAa,CAAC,CAAC,CACzC,cAAe,CAAAmC,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}