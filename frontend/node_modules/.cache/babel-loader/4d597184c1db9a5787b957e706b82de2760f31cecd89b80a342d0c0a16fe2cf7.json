{"ast":null,"code":"import React,{useEffect}from'react';import{useNavigate}from'react-router-dom';import{FaSignOutAlt,FaUserCircle,FaTrashAlt}from'react-icons/fa';import{useAuth}from'../context/AuthContext';import ProfileTab from'../components/profile/ProfileTab';import axios from'axios';// Asegúrate de tener axios\nimport'../styles/Profile.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';const Profile=()=>{const navigate=useNavigate();const{user,isAuthenticated,logout,login,loading}=useAuth();useEffect(()=>{if(!loading&&!isAuthenticated()){navigate('/login');}},[isAuthenticated,navigate,loading]);const handleDeleteAccount=async()=>{const confirmDelete=window.confirm(\"¿Estás completamente seguro? Esta acción eliminará todos tus datos permanentemente y no se puede deshacer.\");if(confirmDelete){try{// ✅ CAMBIO: sessionStorage en lugar de localStorage\nconst token=sessionStorage.getItem('token');if(!token){alert('No se encontró token de autenticación');return;}await axios.delete(\"\".concat(API_URL,\"/auth/profile\"),{headers:{Authorization:\"Bearer \".concat(token)}});alert(\"Cuenta eliminada con éxito.\");logout();// Cerramos sesión y redirigimos\n}catch(err){console.error('Error al eliminar cuenta:',err);alert(\"Error al intentar eliminar la cuenta. Inténtalo de nuevo más tarde.\");}}};if(loading)return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-screen\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Cargando tu cuenta...\"})]});if(!user)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page-luxury\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-bg-accent\"}),/*#__PURE__*/_jsx(\"div\",{className:\"container profile-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar-wrapper\",children:/*#__PURE__*/_jsx(FaUserCircle,{className:\"user-avatar-icon\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-welcome-text\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Hola, \",user.name.split(' ')[0]]}),/*#__PURE__*/_jsx(\"p\",{children:\"Bienvenido a tu panel de control\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-title\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Informaci\\xF3n Personal\"}),/*#__PURE__*/_jsx(\"div\",{className:\"title-underline\"})]}),/*#__PURE__*/_jsx(ProfileTab,{user:user,login:login})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card-footer\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn-logout-luxury\",onClick:logout,children:[/*#__PURE__*/_jsx(FaSignOutAlt,{}),\" \",/*#__PURE__*/_jsx(\"span\",{children:\"Cerrar sesi\\xF3n\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"danger-zone-separator\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Zona de Peligro\"})}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-delete-account\",onClick:handleDeleteAccount,children:[/*#__PURE__*/_jsx(FaTrashAlt,{}),\" \",/*#__PURE__*/_jsx(\"span\",{children:\"Eliminar mi cuenta permanentemente\"})]})]})]})})]});};export default Profile;","map":{"version":3,"names":["React","useEffect","useNavigate","FaSignOutAlt","FaUserCircle","FaTrashAlt","useAuth","ProfileTab","axios","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","Profile","navigate","user","isAuthenticated","logout","login","loading","handleDeleteAccount","confirmDelete","window","confirm","token","sessionStorage","getItem","alert","delete","concat","headers","Authorization","err","console","error","className","children","name","split","onClick"],"sources":["C:/Users/ashu_/Documents/ecommerce-sim/frontend/src/pages/Profile.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { FaSignOutAlt, FaUserCircle, FaTrashAlt } from 'react-icons/fa';\nimport { useAuth } from '../context/AuthContext';\nimport ProfileTab from '../components/profile/ProfileTab';\nimport axios from 'axios'; // Asegúrate de tener axios\nimport '../styles/Profile.css';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n\nconst Profile = () => {\n  const navigate = useNavigate();\n  const { user, isAuthenticated, logout, login, loading } = useAuth();\n\n  useEffect(() => {\n    if (!loading && !isAuthenticated()) {\n      navigate('/login');\n    }\n  }, [isAuthenticated, navigate, loading]);\n\n  const handleDeleteAccount = async () => {\n  const confirmDelete = window.confirm(\n    \"¿Estás completamente seguro? Esta acción eliminará todos tus datos permanentemente y no se puede deshacer.\"\n  );\n\n  if (confirmDelete) {\n    try {\n      // ✅ CAMBIO: sessionStorage en lugar de localStorage\n      const token = sessionStorage.getItem('token');\n      \n      if (!token) {\n        alert('No se encontró token de autenticación');\n        return;\n      }\n\n      await axios.delete(`${API_URL}/auth/profile`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      \n      alert(\"Cuenta eliminada con éxito.\");\n      logout(); // Cerramos sesión y redirigimos\n      \n    } catch (err) {\n      console.error('Error al eliminar cuenta:', err);\n      alert(\"Error al intentar eliminar la cuenta. Inténtalo de nuevo más tarde.\");\n    }\n  }\n};\n\n  if (loading) return <div className=\"loading-screen\"><div className=\"spinner\"></div><p>Cargando tu cuenta...</p></div>;\n  if (!user) return null;\n\n  return (\n    <div className=\"profile-page-luxury\">\n      <div className=\"profile-bg-accent\"></div>\n      <div className=\"container profile-container\">\n        \n        <div className=\"profile-card-main\">\n          <div className=\"profile-card-header\">\n            <div className=\"user-avatar-wrapper\">\n              <FaUserCircle className=\"user-avatar-icon\" />\n            </div>\n            <div className=\"user-welcome-text\">\n              <h1>Hola, {user.name.split(' ')[0]}</h1>\n              <p>Bienvenido a tu panel de control</p>\n            </div>\n          </div>\n\n          <div className=\"profile-card-body\">\n            <div className=\"section-title\">\n              <h3>Información Personal</h3>\n              <div className=\"title-underline\"></div>\n            </div>\n            \n            <ProfileTab user={user} login={login} />\n          </div>\n\n          {/* ÁREA DE ACCIONES */}\n          <div className=\"profile-card-footer\">\n            <button className=\"btn-logout-luxury\" onClick={logout}>\n              <FaSignOutAlt /> <span>Cerrar sesión</span>\n            </button>\n\n            <div className=\"danger-zone-separator\">\n              <span>Zona de Peligro</span>\n            </div>\n\n            <button className=\"btn-delete-account\" onClick={handleDeleteAccount}>\n              <FaTrashAlt /> <span>Eliminar mi cuenta permanentemente</span>\n            </button>\n          </div>\n        </div>\n\n      </div>\n    </div>\n  );\n};\n\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}